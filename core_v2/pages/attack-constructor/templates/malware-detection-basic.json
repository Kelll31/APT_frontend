{
  "id": "malware-detection-basic",
  "name": "Basic Malware Detection",
  "description": "Базовое правило для обнаружения известного вредоносного ПО по хешам файлов и подозрительному поведению",
  "version": "1.2.0",
  "author": "IP Roast Security Team",
  "category": "security",
  "tags": ["malware", "basic", "hash", "behavior"],
  "created": "2024-01-10T14:30:00Z",
  "updated": "2024-01-15T09:15:00Z",
  "components": [
    {
      "type": "file-hash",
      "parameters": {
        "hash_type": "sha256",
        "hash_value": "e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855",
        "file_path": "*"
      }
    },
    {
      "type": "file-size", 
      "parameters": {
        "size": 1024,
        "unit": "KB",
        "operator": "gt"
      }
    },
    {
      "type": "pe-header",
      "parameters": {
        "field": "characteristics",
        "value": "0x0102",
        "operator": "eq"
      }
    },
    {
      "type": "frequency-analysis",
      "parameters": {
        "event_type": "file_access", 
        "threshold": 100,
        "time_window": 60,
        "operator": "gt"
      }
    }
  ],
  "connections": [
    {
      "from": { "index": 0, "pointType": "output" },
      "to": { "index": 1, "pointType": "input" },
      "operator": "AND"
    },
    {
      "from": { "index": 1, "pointType": "output" },
      "to": { "index": 2, "pointType": "input" },
      "operator": "AND"
    },
    {
      "from": { "index": 2, "pointType": "output" },
      "to": { "index": 3, "pointType": "input" },
      "operator": "OR"
    }
  ],
  "settings": {
    "rule": {
      "type": "detection",
      "priority": "high"
    },
    "layout": {
      "startX": 100,
      "startY": 100,
      "spacing": 250
    }
  },
  "metadata": {
    "complexity": "medium",
    "estimatedMatches": "low",
    "falsePositiveRate": "very-low",
    "documentation": "https://docs.iproast.com/templates/malware-basic"
  }
}
