{
  "id": "data-exfiltration-dns",
  "name": "DNS Data Exfiltration Detection",
  "description": "Обнаружение экфильтрации данных через DNS туннелирование с анализом частоты запросов и размера ответов",
  "version": "1.3.0",
  "author": "IP Roast Detection Team",
  "category": "network",
  "tags": ["dns", "exfiltration", "tunneling", "advanced"],
  "created": "2024-01-12T08:45:00Z",
  "updated": "2024-01-15T12:30:00Z",
  "components": [
    {
      "type": "dns-query",
      "parameters": {
        "domain": "*.suspicious-domain.com",
        "query_type": "TXT",
        "response_code": "NOERROR"
      }
    },
    {
      "type": "frequency-analysis",
      "parameters": {
        "event_type": "dns_request",
        "threshold": 30,
        "time_window": 60,
        "operator": "gt"
      }
    },
    {
      "type": "payload-size",
      "parameters": {
        "size": 512,
        "unit": "bytes",
        "operator": "gt"
      }
    },
    {
      "type": "regex-pattern",
      "parameters": {
        "pattern": "[a-f0-9]{16,}",
        "field": "dns.query",
        "flags": "i"
      }
    }
  ],
  "connections": [
    {
      "from": { "index": 0, "pointType": "output" },
      "to": { "index": 1, "pointType": "input" },
      "operator": "AND"
    },
    {
      "from": { "index": 1, "pointType": "output" },
      "to": { "index": 2, "pointType": "input" },
      "operator": "OR"
    },
    {
      "from": { "index": 2, "pointType": "output" },
      "to": { "index": 3, "pointType": "input" },
      "operator": "AND"
    }
  ],
  "settings": {
    "rule": {
      "type": "detection",
      "priority": "high"
    },
    "layout": {
      "startX": 120,
      "startY": 80,
      "spacing": 220
    }
  },
  "metadata": {
    "complexity": "medium",
    "estimatedMatches": "low",
    "falsePositiveRate": "low",
    "performanceImpact": "low",
    "threatTypes": ["data-exfiltration", "dns-tunneling"],
    "documentation": "https://docs.iproast.com/templates/dns-exfiltration"
  }
}
