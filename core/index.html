<!DOCTYPE html>
<html lang="ru">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IP Roast Enterprise 4.0</title>

    <!-- CSS -->
    <link rel="stylesheet" href="styles/layout.css">
    <link rel="stylesheet" href="styles/main.css">
    <link rel="stylesheet" href="styles/sidebar.css">
    <link rel="stylesheet" href="styles/header.css">
    <link rel="stylesheet" href="styles/notifications.css">

    <!-- Preload critical resources -->
    <link rel="preload" href="scripts/component-loader.js" as="script">
    <link rel="preload" href="scripts/main.js" as="script">
    <link rel="preload" href="scripts/sidebar.js" as="script">
    <link rel="preload" href="scripts/header.js" as="script">
    <script src="scripts/notifications.js" defer></script>
</head>

<body>
    <!-- Loading Screen -->
    <div id="loading-screen" class="loading-screen">
        <div class="loading-container">
            <div class="loading-logo">
                <div class="logo-icon">IP</div>
                <div class="logo-text">
                    <h1>IP Roast</h1>
                    <span>Enterprise 4.0</span>
                </div>
            </div>
            <div class="loading-progress">
                <div class="progress-bar">
                    <div id="progress-fill" class="progress-fill"></div>
                </div>
                <div id="progress-text" class="progress-text">–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤...</div>
            </div>
        </div>
    </div>

    <!-- Main Application -->
    <div class="app" id="app">
        <!-- Sidebar Container (–±—É–¥–µ—Ç –∑–∞–≥—Ä—É–∂–µ–Ω –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏) -->
        <div id="sidebar-container"></div>

        <!-- Main Content Area -->
        <main class="main-content">
            <!-- Header Container (–±—É–¥–µ—Ç –∑–∞–≥—Ä—É–∂–µ–Ω –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏) -->
            <div id="header-container"></div>

            <!-- Page Container -->
            <div id="page-container" class="page-container">
                <!-- Page Loading Indicator -->
                <div id="page-loading" class="page-loading">
                    <div class="loading-spinner"></div>
                    <div class="loading-text">–ó–∞–≥—Ä—É–∑–∫–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—ã...</div>
                </div>

                <!-- Page Content -->
                <div id="page-content" class="page-content">
                    <!-- Default Dashboard Content -->
                    <div class="container">
                        <div style="padding: 40px; text-align: center;">
                            <h2>üéØ IP Roast Enterprise 4.0</h2>
                            <p>–°–∏—Å—Ç–µ–º–∞ —É—Å–ø–µ—à–Ω–æ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞ –∏ –≥–æ—Ç–æ–≤–∞ –∫ —Ä–∞–±–æ—Ç–µ!</p>
                            <div class="card" style="max-width: 600px; margin: 20px auto; text-align: left;">
                                <div class="card__body">
                                    <h3>–°—Ç–∞—Ç—É—Å —Å–∏—Å—Ç–µ–º—ã</h3>
                                    <ul>
                                        <li>‚úÖ –Ø–¥—Ä–æ —Å–∏—Å—Ç–µ–º—ã –∑–∞–≥—Ä—É–∂–µ–Ω–æ</li>
                                        <li>‚úÖ –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –∑–∞–≥—Ä—É–∂–µ–Ω—ã –º–æ–¥—É–ª—å–Ω–æ</li>
                                        <li>‚úÖ –ë–æ–∫–æ–≤–æ–µ –º–µ–Ω—é –∞–∫—Ç–∏–≤–Ω–æ</li>
                                        <li>‚úÖ –ó–∞–≥–æ–ª–æ–≤–æ–∫ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∏—Ä—É–µ—Ç</li>
                                        <li>‚úÖ –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã</li>
                                        <li>‚úÖ –ù–∞–≤–∏–≥–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç</li>
                                    </ul>
                                    <div
                                        style="margin-top: 20px; padding: 15px; background: var(--color-bg-3); border-radius: var(--radius-base); border-left: 4px solid var(--color-success);">
                                        <strong>üîß –ú–æ–¥—É–ª—å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:</strong><br>
                                        ‚Ä¢ Header –∑–∞–≥—Ä—É–∂–µ–Ω –∏–∑: <code>components/header.html</code><br>
                                        ‚Ä¢ Sidebar –∑–∞–≥—Ä—É–∂–µ–Ω –∏–∑: <code>components/sidebar.html</code><br>
                                        ‚Ä¢ –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –∫—ç—à–∏—Ä—É—é—Ç—Å—è –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Toast Notifications Container -->
    <div id="toast-container" class="toast-container"></div>

    <!-- Scripts - Component System -->
    <script src="scripts/component-loader.js"></script>
    <script src="scripts/sidebar.js"></script>
    <script src="scripts/header.js"></script>
    <script src="scripts/page-loader.js"></script>
    <script src="scripts/main.js"></script>

    <!-- Initialize Application with Component Loading -->
    <script>
        // Enhanced initialization —Å –º–æ–¥—É–ª—å–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–æ–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
        document.addEventListener('DOMContentLoaded', async function () {
            console.log('üöÄ DOM –≥–æ—Ç–æ–≤, –∑–∞–ø—É—Å–∫–∞–µ–º IP Roast Enterprise 4.0 —Å –º–æ–¥—É–ª—å–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–æ–π');

            try {
                // –û–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å –∑–∞–≥—Ä—É–∑–∫–∏
                const updateProgress = (percent, text) => {
                    const progressFill = document.getElementById('progress-fill');
                    const progressText = document.getElementById('progress-text');
                    if (progressFill) progressFill.style.width = `${percent}%`;
                    if (progressText) progressText.textContent = text;
                };

                updateProgress(20, '–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∑–∞–≥—Ä—É–∑—á–∏–∫–∞ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤...');

                // –°–æ–∑–¥–∞–µ–º –º–µ–Ω–µ–¥–∂–µ—Ä –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
                window.componentManager = new IPRoastComponentManager();

                updateProgress(40, '–ó–∞–≥—Ä—É–∑–∫–∞ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞...');

                // –ó–∞–≥—Ä—É–∂–∞–µ–º –≤—Å–µ –æ—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
                await window.componentManager.loadAllComponents();

                updateProgress(70, '–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è...');

                // –°–æ–∑–¥–∞–µ–º –æ—Å–Ω–æ–≤–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
                window.ipRoastApp = new IPRoastApp();

                updateProgress(90, '–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤...');

                // –ò–Ω—Ç–µ–≥—Ä–∏—Ä—É–µ–º –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å –æ—Å–Ω–æ–≤–Ω—ã–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º
                if (window.sidebarManager) {
                    window.ipRoastApp.components.sidebar = window.sidebarManager;

                    // –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π
                    window.sidebarManager.on('navigate', (pageId) => {
                        window.ipRoastApp.navigateToPage(pageId);
                    });

                    window.sidebarManager.on('collapsed', (isCollapsed) => {
                        window.ipRoastApp.state.sidebarCollapsed = isCollapsed;
                        window.ipRoastApp.saveState();
                    });
                }

                if (window.headerManager) {
                    window.ipRoastApp.components.header = window.headerManager;
                }

                updateProgress(100, '–°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ —Ä–∞–±–æ—Ç–µ!');

                // –°–∫—Ä—ã–≤–∞–µ–º —ç–∫—Ä–∞–Ω –∑–∞–≥—Ä—É–∑–∫–∏
                setTimeout(() => {
                    document.getElementById('loading-screen').classList.add('hidden');

                    console.log('‚úÖ IP Roast Enterprise –ø–æ–ª–Ω–æ—Å—Ç—å—é –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω —Å –º–æ–¥—É–ª—å–Ω—ã–º–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏');
                    console.log('üì¶ –ó–∞–≥—Ä—É–∂–µ–Ω—ã –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:', window.componentManager.getLoader().getStats());
                }, 1000);

                // Development helpers
                if (localStorage.getItem('dev-mode') !== 'false') {
                    console.log('üîß –†–µ–∂–∏–º —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –∞–∫—Ç–∏–≤–µ–Ω');
                    window.dev = {
                        app: window.ipRoastApp,
                        componentManager: window.componentManager,
                        loader: window.componentManager.getLoader(),
                        sidebar: window.sidebarManager,
                        header: window.headerManager,
                        stats: () => window.componentManager.getLoader().getStats(),
                        reloadComponent: (name, container) => window.componentManager.getLoader().reloadComponent(name, container)
                    };
                }

            } catch (error) {
                console.error('‚ùå –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤:', error);

                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –æ—à–∏–±–∫—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
                const loadingScreen = document.getElementById('loading-screen');
                if (loadingScreen) {
                    loadingScreen.innerHTML = `
                        <div class="loading-container">
                            <div class="error-icon" style="font-size: 64px; color: var(--color-error); margin-bottom: 20px;">‚ùå</div>
                            <h2>–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤</h2>
                            <p>–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –º–æ–¥—É–ª—å–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å–∏—Å—Ç–µ–º—ã.</p>
                            <p class="error-message" style="font-family: monospace; color: var(--color-error);">${error.message}</p>
                            <div style="margin-top: 30px;">
                                <button onclick="location.reload()" class="btn btn--primary">–ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å</button>
                                <button onclick="localStorage.clear(); location.reload()" class="btn btn--secondary" style="margin-left: 10px;">
                                    –û—á–∏—Å—Ç–∏—Ç—å –∫—ç—à –∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å
                                </button>
                            </div>
                        </div>
                    `;
                }
            }
        });

        // –ì–ª–æ–±–∞–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –±—ã—Å—Ç—Ä–æ–π –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ (–¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏)
        window.reloadComponents = async function () {
            console.log('üîÑ –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤...');
            try {
                if (window.componentManager) {
                    // –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ–º sidebar
                    await window.componentManager.getLoader().reloadComponent('sidebar', 'sidebar-container');
                    // –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ–º header
                    await window.componentManager.getLoader().reloadComponent('header', 'header-container');

                    console.log('‚úÖ –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —É—Å–ø–µ—à–Ω–æ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–µ–Ω—ã');
                }
            } catch (error) {
                console.error('‚ùå –û—à–∏–±–∫–∞ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤:', error);
            }
        };
    </script>
</body>

</html>