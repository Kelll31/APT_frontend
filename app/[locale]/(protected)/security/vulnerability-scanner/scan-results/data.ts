export interface VulnerabilityItem {
    id: string;
    name: string;
    severity: 'critical' | 'high' | 'medium' | 'low' | 'informational';
    cvss: number;
    cve?: string;
    category: string;
    description: string;
    impact: string;
    solution: string;
    references: string[];
    host: string;
    port?: number;
    service?: string;
    firstFound: string;
    lastSeen: string;
    status: 'open' | 'fixed' | 'mitigated' | 'false_positive' | 'accepted_risk';
    exploitable: boolean;
    patchAvailable: boolean;
    evidence: string[];
}

export interface ScanResult {
    id: string;
    scanId: string;
    scanName: string;
    target: string;
    startTime: string;
    endTime: string;
    duration: string;
    status: 'completed' | 'failed' | 'partial';
    vulnerabilities: VulnerabilityItem[];
    summary: {
        critical: number;
        high: number;
        medium: number;
        low: number;
        informational: number;
        total: number;
    };
    hostsScanned: number;
    portsScanned: number;
    servicesIdentified: number;
    complianceScore: number;
    riskScore: number;
}

export const scanResultData: ScanResult = {
    id: 'result-001',
    scanId: 'scan-001',
    scanName: 'Комплексное сканирование корпоративной сети',
    target: '192.168.1.0/24',
    startTime: '2025-08-15T14:30:00Z',
    endTime: '2025-08-15T16:45:00Z',
    duration: '2ч 15мин',
    status: 'completed',
    summary: {
        critical: 3,
        high: 8,
        medium: 15,
        low: 12,
        informational: 25,
        total: 63
    },
    hostsScanned: 45,
    portsScanned: 2250,
    servicesIdentified: 127,
    complianceScore: 78,
    riskScore: 8.5,
    vulnerabilities: [
        {
            id: 'vuln-001',
            name: 'SQL Injection в форме входа',
            severity: 'critical',
            cvss: 9.8,
            cve: 'CVE-2024-1234',
            category: 'Injection Flaws',
            description: 'Обнаружена SQL-инъекция в параметре login формы аутентификации. Злоумышленник может получить полный доступ к базе данных.',
            impact: 'Полная компрометация базы данных, утечка конфиденциальных данных, возможность изменения данных.',
            solution: 'Использовать параметризованные запросы (prepared statements), валидировать входные данные, применить принцип наименьших привилегий для БД.',
            references: [
                'https://owasp.org/www-project-top-ten/2017/A1_2017-Injection',
                'https://cwe.mitre.org/data/definitions/89.html'
            ],
            host: '192.168.1.10',
            port: 80,
            service: 'HTTP',
            firstFound: '2025-08-15T15:23:00Z',
            lastSeen: '2025-08-15T15:23:00Z',
            status: 'open',
            exploitable: true,
            patchAvailable: false,
            evidence: [
                'POST /login.php HTTP/1.1',
                'username=admin\' OR 1=1--&password=test',
                'HTTP/1.1 200 OK - Login successful'
            ]
        },
        {
            id: 'vuln-002',
            name: 'Устаревшая версия OpenSSL',
            severity: 'high',
            cvss: 7.5,
            cve: 'CVE-2023-5678',
            category: 'Components with Known Vulnerabilities',
            description: 'Сервер использует устаревшую версию OpenSSL 1.1.1f с известными уязвимостями.',
            impact: 'Возможность проведения атак на SSL/TLS соединения, перехват зашифрованного трафика.',
            solution: 'Обновить OpenSSL до последней стабильной версии 3.1.x.',
            references: [
                'https://www.openssl.org/news/secadv/20231024.txt',
                'https://nvd.nist.gov/vuln/detail/CVE-2023-5678'
            ],
            host: '192.168.1.5',
            port: 443,
            service: 'HTTPS',
            firstFound: '2025-08-15T14:45:00Z',
            lastSeen: '2025-08-15T14:45:00Z',
            status: 'open',
            exploitable: true,
            patchAvailable: true,
            evidence: [
                'SSL Version: OpenSSL 1.1.1f',
                'Certificate Details: Subject: CN=internal.company.com'
            ]
        },
        {
            id: 'vuln-003',
            name: 'Незащищенная директория /admin/',
            severity: 'high',
            cvss: 7.2,
            category: 'Broken Access Control',
            description: 'Обнаружена незащищенная административная панель, доступная без аутентификации.',
            impact: 'Несанкционированный доступ к административным функциям системы.',
            solution: 'Настроить аутентификацию для доступа к административной панели, ограничить доступ по IP.',
            references: [
                'https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control'
            ],
            host: '192.168.1.15',
            port: 80,
            service: 'HTTP',
            firstFound: '2025-08-15T15:10:00Z',
            lastSeen: '2025-08-15T15:10:00Z',
            status: 'open',
            exploitable: true,
            patchAvailable: false,
            evidence: [
                'GET /admin/ HTTP/1.1',
                'HTTP/1.1 200 OK',
                'Content: <title>Admin Panel</title>'
            ]
        },
        {
            id: 'vuln-004',
            name: 'Слабые SSL/TLS настройки',
            severity: 'medium',
            cvss: 5.3,
            category: 'Security Misconfiguration',
            description: 'Сервер поддерживает устаревшие протоколы SSL/TLS и слабые алгоритмы шифрования.',
            impact: 'Возможность проведения атак на шифрование, снижение защищенности передаваемых данных.',
            solution: 'Отключить поддержку TLS 1.0/1.1, настроить только сильные алгоритмы шифрования.',
            references: [
                'https://wiki.mozilla.org/Security/Server_Side_TLS'
            ],
            host: '192.168.1.20',
            port: 443,
            service: 'HTTPS',
            firstFound: '2025-08-15T14:50:00Z',
            lastSeen: '2025-08-15T14:50:00Z',
            status: 'open',
            exploitable: false,
            patchAvailable: false,
            evidence: [
                'Supported Protocols: TLS 1.0, TLS 1.1, TLS 1.2',
                'Cipher Suites: includes weak ciphers'
            ]
        },
        {
            id: 'vuln-005',
            name: 'Отсутствие заголовков безопасности',
            severity: 'low',
            cvss: 3.1,
            category: 'Security Misconfiguration',
            description: 'Веб-сервер не отправляет важные заголовки безопасности HTTP.',
            impact: 'Повышенный риск XSS атак, clickjacking и других клиентских атак.',
            solution: 'Добавить заголовки: X-Frame-Options, X-XSS-Protection, X-Content-Type-Options, Content-Security-Policy.',
            references: [
                'https://owasp.org/www-project-secure-headers/'
            ],
            host: '192.168.1.25',
            port: 80,
            service: 'HTTP',
            firstFound: '2025-08-15T15:30:00Z',
            lastSeen: '2025-08-15T15:30:00Z',
            status: 'open',
            exploitable: false,
            patchAvailable: false,
            evidence: [
                'Missing Headers: X-Frame-Options, X-XSS-Protection, CSP'
            ]
        },
        {
            id: 'vuln-006',
            name: 'Информация о версии сервера',
            severity: 'informational',
            cvss: 0.0,
            category: 'Information Disclosure',
            description: 'Сервер раскрывает информацию о своей версии в HTTP заголовках.',
            impact: 'Информация может быть использована злоумышленниками для подготовки целенаправленных атак.',
            solution: 'Скрыть или изменить информацию о версии сервера в конфигурации.',
            references: [
                'https://owasp.org/www-project-web-security-testing-guide/v42/4-Web_Application_Security_Testing/01-Information_Gathering/08-Fingerprint_Web_Server'
            ],
            host: '192.168.1.30',
            port: 80,
            service: 'HTTP',
            firstFound: '2025-08-15T16:00:00Z',
            lastSeen: '2025-08-15T16:00:00Z',
            status: 'open',
            exploitable: false,
            patchAvailable: false,
            evidence: [
                'Server: Apache/2.4.41 (Ubuntu)'
            ]
        }
    ]
};

// Статистика по хостам
export const hostStatistics = [
    {
        host: '192.168.1.10',
        vulnerabilities: { critical: 1, high: 0, medium: 2, low: 1, informational: 3 },
        services: ['HTTP', 'SSH', 'FTP'],
        riskScore: 9.2
    },
    {
        host: '192.168.1.5',
        vulnerabilities: { critical: 0, high: 2, medium: 1, low: 0, informational: 2 },
        services: ['HTTPS', 'SSH'],
        riskScore: 7.8
    },
    {
        host: '192.168.1.15',
        vulnerabilities: { critical: 0, high: 1, medium: 0, low: 2, informational: 1 },
        services: ['HTTP', 'MySQL'],
        riskScore: 6.5
    }
];

// Категории уязвимостей
export const vulnerabilityCategories = Array.from(
    new Set(scanResultData.vulnerabilities.map(v => v.category))
);

// Хосты
export const uniqueHosts = Array.from(
    new Set(scanResultData.vulnerabilities.map(v => v.host))
);

// Статусы уязвимостей
export const vulnerabilityStatuses = Array.from(
    new Set(scanResultData.vulnerabilities.map(v => v.status))
);
