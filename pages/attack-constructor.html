<!-- pages/attack-constructor.html -->
<!-- Advanced Attack Constructor module for IP Roast Enterprise 4.0 -->
<!-- Enhanced with full functionality from attack-constructor folder -->

<!-- All Attack Constructor Styles -->
<link rel="stylesheet" href="../attack-constructor/attack-builder.css">
<link rel="stylesheet" href="../attack-constructor/constructor-styles.css">
<link rel="stylesheet" href="../attack-constructor/exploit-library.css">
<link rel="stylesheet" href="../attack-constructor/payload-editor.css">

<!-- Attack Constructor Container -->
<div class="attack-constructor" id="attack-constructor">

    <!-- Constructor Header -->
    <header class="constructor-header">
        <div class="header-left">
            <div class="title-section">
                <h1 class="constructor-title">
                    <i class="fas fa-hammer"></i>
                    –ö–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä –∞—Ç–∞–∫
                </h1>
                <div class="version-info">Enterprise Attack Builder 4.0</div>
            </div>

            <div class="workflow-info" id="workflow-info">
                <div class="workflow-name">–ù–æ–≤—ã–π —Ä–∞–±–æ—á–∏–π –ø—Ä–æ—Ü–µ—Å—Å</div>
                <div class="workflow-status">
                    <span class="status-indicator status-draft"></span>
                    <span class="status-text">–ß–µ—Ä–Ω–æ–≤–∏–∫</span>
                </div>
            </div>
        </div>

        <div class="header-controls">
            <!-- Workflow Templates -->
            <div class="template-selector">
                <label for="workflow-template">–®–∞–±–ª–æ–Ω:</label>
                <select id="workflow-template" class="template-select">
                    <option value="">–í—ã–±–µ—Ä–∏—Ç–µ —à–∞–±–ª–æ–Ω</option>
                    <option value="basic_pentest">–ë–∞–∑–æ–≤—ã–π –ø–µ–Ω—Ç–µ—Å—Ç</option>
                    <option value="advanced_apt">–ü—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è APT –∞—Ç–∞–∫–∞</option>
                    <option value="web_application">–í–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ</option>
                    <option value="network_infrastructure">–°–µ—Ç–µ–≤–∞—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞</option>
                    <option value="social_engineering">–°–æ—Ü–∏–∞–ª—å–Ω–∞—è –∏–Ω–∂–µ–Ω–µ—Ä–∏—è</option>
                    <option value="custom">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π</option>
                </select>
            </div>

            <!-- Action Buttons -->
            <div class="action-buttons">
                <button class="action-btn" id="validate-workflow" title="–í–∞–ª–∏–¥–∞—Ü–∏—è —Ä–∞–±–æ—á–µ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞">
                    <i class="fas fa-check-circle"></i>
                    <span class="btn-text">–í–∞–ª–∏–¥–∞—Ü–∏—è</span>
                </button>
                <button class="action-btn" id="test-workflow" title="–¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å workflow">
                    <i class="fas fa-play"></i>
                    <span class="btn-text">–¢–µ—Å—Ç</span>
                </button>
                <button class="action-btn" id="save-workflow" title="–°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ä–∞–±–æ—á–∏–π –ø—Ä–æ—Ü–µ—Å—Å">
                    <i class="fas fa-save"></i>
                    <span class="btn-text">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</span>
                </button>
                <button class="action-btn" id="export-workflow" title="–≠–∫—Å–ø–æ—Ä—Ç workflow">
                    <i class="fas fa-download"></i>
                    <span class="btn-text">–≠–∫—Å–ø–æ—Ä—Ç</span>
                </button>
            </div>
        </div>
    </header>

    <!-- Main Constructor Layout -->
    <div class="constructor-main">

        <!-- Module Library Sidebar -->
        <aside class="module-library" id="module-library">
            <div class="library-header">
                <h3 class="library-title">
                    <i class="fas fa-cube"></i>
                    –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ –º–æ–¥—É–ª–µ–π
                </h3>
                <button class="library-toggle" id="library-toggle" title="–°–≤–µ—Ä–Ω—É—Ç—å/—Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—å">
                    <i class="fas fa-chevron-left"></i>
                </button>
            </div>

            <div class="library-content">
                <!-- Search and Filter -->
                <div class="library-search">
                    <div class="search-container">
                        <input type="text" class="search-input" placeholder="–ü–æ–∏—Å–∫ –º–æ–¥—É–ª–µ–π..." id="module-search">
                        <i class="search-icon fas fa-search"></i>
                    </div>

                    <div class="filter-container">
                        <select class="filter-select" id="category-filter">
                            <option value="all">–í—Å–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</option>
                            <option value="signature_analysis">–°–∏–≥–Ω–∞—Ç—É—Ä–Ω—ã–π –∞–Ω–∞–ª–∏–∑</option>
                            <option value="intelligence">–ò–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω—ã–µ –º–æ–¥—É–ª–∏</option>
                            <option value="reconnaissance">–†–∞–∑–≤–µ–¥–∫–∞</option>
                            <option value="attacks">–ú–æ–¥—É–ª–∏ –∞—Ç–∞–∫</option>
                            <option value="post_exploitation">–ü–æ—Å—Ç-—ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—è</option>
                            <option value="evasion">–ú–æ–¥—É–ª–∏ —É–∫–ª–æ–Ω–µ–Ω–∏—è</option>
                            <option value="analytics">–ê–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–µ –º–æ–¥—É–ª–∏</option>
                            <option value="system">–°–∏—Å—Ç–µ–º–Ω—ã–µ –º–æ–¥—É–ª–∏</option>
                        </select>
                    </div>
                </div>

                <!-- Module Categories -->
                <div class="module-categories" id="module-categories">

                    <!-- Signature Analysis Category -->
                    <div class="category-section" data-category="signature_analysis">
                        <div class="category-header" onclick="toggleCategory('signature_analysis')">
                            <h4 class="category-title">
                                <i class="category-icon fas fa-search" style="color: #3B82F6;"></i>
                                –°–∏–≥–Ω–∞—Ç—É—Ä–Ω—ã–π –∞–Ω–∞–ª–∏–∑
                            </h4>
                            <span class="category-count">3</span>
                            <i class="category-toggle fas fa-chevron-down"></i>
                        </div>
                        <div class="category-modules">
                            <div class="module-item" draggable="true" data-module="sig_scanner">
                                <div class="module-icon">
                                    <i class="fas fa-search"></i>
                                </div>
                                <div class="module-info">
                                    <div class="module-name">–°–∫–∞–Ω–µ—Ä —Å–∏–≥–Ω–∞—Ç—É—Ä</div>
                                    <div class="module-description">–ë–∞–∑–æ–≤–æ–µ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –∞–Ω–∞–ª–∏–∑ –æ—Ç–ø–µ—á–∞—Ç–∫–æ–≤ —Å–µ—Ä–≤–∏—Å–æ–≤
                                    </div>
                                </div>
                                <div class="module-ports">
                                    <div class="port input" title="–í—Ö–æ–¥—ã: target"></div>
                                    <div class="port output" title="–í—ã—Ö–æ–¥—ã: signatures"></div>
                                </div>
                            </div>

                            <div class="module-item" draggable="true" data-module="service_detector">
                                <div class="module-icon">
                                    <i class="fas fa-network-wired"></i>
                                </div>
                                <div class="module-info">
                                    <div class="module-name">–î–µ—Ç–µ–∫—Ç–æ—Ä —Å–µ—Ä–≤–∏—Å–æ–≤</div>
                                    <div class="module-description">–ò–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω–∞—è –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è —Ç–∏–ø–æ–≤ —Å–µ—Ä–≤–∏—Å–æ–≤</div>
                                </div>
                                <div class="module-ports">
                                    <div class="port input" title="–í—Ö–æ–¥—ã: signatures"></div>
                                    <div class="port output" title="–í—ã—Ö–æ–¥—ã: services"></div>
                                </div>
                            </div>

                            <div class="module-item" draggable="true" data-module="vuln_matcher">
                                <div class="module-icon">
                                    <i class="fas fa-shield-alt"></i>
                                </div>
                                <div class="module-info">
                                    <div class="module-name">–°–æ–ø–æ—Å—Ç–∞–≤–∏—Ç–µ–ª—å —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π</div>
                                    <div class="module-description">–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–∏—Å–∫ CVE –¥–ª—è –æ–±–Ω–∞—Ä—É–∂–µ–Ω–Ω—ã—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
                                    </div>
                                </div>
                                <div class="module-ports">
                                    <div class="port input" title="–í—Ö–æ–¥—ã: services"></div>
                                    <div class="port output" title="–í—ã—Ö–æ–¥—ã: vulnerabilities"></div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Intelligence Category -->
                    <div class="category-section" data-category="intelligence">
                        <div class="category-header" onclick="toggleCategory('intelligence')">
                            <h4 class="category-title">
                                <i class="category-icon fas fa-brain" style="color: #8B5CF6;"></i>
                                –ò–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω—ã–µ –º–æ–¥—É–ª–∏
                            </h4>
                            <span class="category-count">3</span>
                            <i class="category-toggle fas fa-chevron-down"></i>
                        </div>
                        <div class="category-modules">
                            <div class="module-item" draggable="true" data-module="decision_engine">
                                <div class="module-icon">
                                    <i class="fas fa-brain"></i>
                                </div>
                                <div class="module-info">
                                    <div class="module-name">–î–≤–∏–∂–æ–∫ –ø—Ä–∏–Ω—è—Ç–∏—è —Ä–µ—à–µ–Ω–∏–π</div>
                                    <div class="module-description">–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π –ò–ò-–º–æ–¥—É–ª—å —Å–∏—Å—Ç–µ–º—ã</div>
                                </div>
                                <div class="module-ports">
                                    <div class="port input" title="–í—Ö–æ–¥—ã: vulnerabilities, context"></div>
                                    <div class="port output" title="–í—ã—Ö–æ–¥—ã: decisions, priorities"></div>
                                </div>
                            </div>

                            <div class="module-item" draggable="true" data-module="adaptive_selector">
                                <div class="module-icon">
                                    <i class="fas fa-user-secret"></i>
                                </div>
                                <div class="module-info">
                                    <div class="module-name">–ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π —Å–µ–ª–µ–∫—Ç–æ—Ä</div>
                                    <div class="module-description">–î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π –≤—ã–±–æ—Ä —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –∞—Ç–∞–∫</div>
                                </div>
                                <div class="module-ports">
                                    <div class="port input" title="–í—Ö–æ–¥—ã: decisions"></div>
                                    <div class="port output" title="–í—ã—Ö–æ–¥—ã: strategy"></div>
                                </div>
                            </div>

                            <div class="module-item" draggable="true" data-module="priority_analyzer">
                                <div class="module-icon">
                                    <i class="fas fa-list-ol"></i>
                                </div>
                                <div class="module-info">
                                    <div class="module-name">–ê–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–≤</div>
                                    <div class="module-description">–†–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏–µ —Ü–µ–ª–µ–π –ø–æ –∫—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç–∏</div>
                                </div>
                                <div class="module-ports">
                                    <div class="port input" title="–í—Ö–æ–¥—ã: strategy, vulnerabilities"></div>
                                    <div class="port output" title="–í—ã—Ö–æ–¥—ã: ranked_targets"></div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Reconnaissance Category -->
                    <div class="category-section" data-category="reconnaissance">
                        <div class="category-header" onclick="toggleCategory('reconnaissance')">
                            <h4 class="category-title">
                                <i class="category-icon fas fa-globe" style="color: #10B981;"></i>
                                –†–∞–∑–≤–µ–¥–∫–∞
                            </h4>
                            <span class="category-count">3</span>
                            <i class="category-toggle fas fa-chevron-down"></i>
                        </div>
                        <div class="category-modules">
                            <div class="module-item" draggable="true" data-module="osint_collector">
                                <div class="module-icon">
                                    <i class="fas fa-globe"></i>
                                </div>
                                <div class="module-info">
                                    <div class="module-name">OSINT —Å–±–æ—Ä—â–∏–∫</div>
                                    <div class="module-description">–°–±–æ—Ä –æ—Ç–∫—Ä—ã—Ç–æ–π —Ä–∞–∑–≤–µ–¥—ã–≤–∞—Ç–µ–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏</div>
                                </div>
                                <div class="module-ports">
                                    <div class="port input" title="–í—Ö–æ–¥—ã: target"></div>
                                    <div class="port output" title="–í—ã—Ö–æ–¥—ã: osint_data"></div>
                                </div>
                            </div>

                            <div class="module-item" draggable="true" data-module="dns_enum">
                                <div class="module-icon">
                                    <i class="fas fa-database"></i>
                                </div>
                                <div class="module-info">
                                    <div class="module-name">DNS –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–∏–µ</div>
                                    <div class="module-description">–ü–µ—Ä–µ—á–∏—Å–ª–µ–Ω–∏–µ DNS –∑–∞–ø–∏—Å–µ–π –∏ —Å—É–±–¥–æ–º–µ–Ω–æ–≤</div>
                                </div>
                                <div class="module-ports">
                                    <div class="port input" title="–í—Ö–æ–¥—ã: target"></div>
                                    <div class="port output" title="–í—ã—Ö–æ–¥—ã: dns_records"></div>
                                </div>
                            </div>

                            <div class="module-item" draggable="true" data-module="social_engineer">
                                <div class="module-icon">
                                    <i class="fas fa-mask"></i>
                                </div>
                                <div class="module-info">
                                    <div class="module-name">–°–æ—Ü–∏–∞–ª—å–Ω–∞—è –∏–Ω–∂–µ–Ω–µ—Ä–∏—è</div>
                                    <div class="module-description">–ú–æ–¥—É–ª—å —Å–æ—Ü–∏–∞–ª—å–Ω–æ–π –∏–Ω–∂–µ–Ω–µ—Ä–∏–∏ –∏ —Ñ–∏—à–∏–Ω–≥–∞</div>
                                </div>
                                <div class="module-ports">
                                    <div class="port input" title="–í—Ö–æ–¥—ã: osint_data"></div>
                                    <div class="port output" title="–í—ã—Ö–æ–¥—ã: social_vectors"></div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Attack Modules Category -->
                    <div class="category-section" data-category="attacks">
                        <div class="category-header" onclick="toggleCategory('attacks')">
                            <h4 class="category-title">
                                <i class="category-icon fas fa-bomb" style="color: #EF4444;"></i>
                                –ú–æ–¥—É–ª–∏ –∞—Ç–∞–∫
                            </h4>
                            <span class="category-count">4</span>
                            <i class="category-toggle fas fa-chevron-down"></i>
                        </div>
                        <div class="category-modules">
                            <div class="module-item" draggable="true" data-module="web_attacks">
                                <div class="module-icon">
                                    <i class="fas fa-bug"></i>
                                </div>
                                <div class="module-info">
                                    <div class="module-name">–í–µ–±-–∞—Ç–∞–∫–∏</div>
                                    <div class="module-description">SQL-–∏–Ω—ä–µ–∫—Ü–∏–∏, XSS, CSRF –∞—Ç–∞–∫–∏</div>
                                </div>
                                <div class="module-ports">
                                    <div class="port input" title="–í—Ö–æ–¥—ã: web_services"></div>
                                    <div class="port output" title="–í—ã—Ö–æ–¥—ã: web_exploits"></div>
                                </div>
                            </div>

                            <div class="module-item" draggable="true" data-module="network_attacks">
                                <div class="module-icon">
                                    <i class="fas fa-bomb"></i>
                                </div>
                                <div class="module-info">
                                    <div class="module-name">–°–µ—Ç–µ–≤—ã–µ –∞—Ç–∞–∫–∏</div>
                                    <div class="module-description">Buffer overflow, DoS, –ø—Ä–æ—Ç–æ–∫–æ–ª—å–Ω—ã–µ –∞—Ç–∞–∫–∏</div>
                                </div>
                                <div class="module-ports">
                                    <div class="port input" title="–í—Ö–æ–¥—ã: network_services"></div>
                                    <div class="port output" title="–í—ã—Ö–æ–¥—ã: network_exploits"></div>
                                </div>
                            </div>

                            <div class="module-item" draggable="true" data-module="auth_bypass">
                                <div class="module-icon">
                                    <i class="fas fa-key"></i>
                                </div>
                                <div class="module-info">
                                    <div class="module-name">–û–±—Ö–æ–¥ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏</div>
                                    <div class="module-description">–ë—Ä—É—Ç—Ñ–æ—Ä—Å, —Å–ª–æ–≤–∞—Ä–Ω—ã–µ –∞—Ç–∞–∫–∏, –æ–±—Ö–æ–¥ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
                                    </div>
                                </div>
                                <div class="module-ports">
                                    <div class="port input" title="–í—Ö–æ–¥—ã: auth_services"></div>
                                    <div class="port output" title="–í—ã—Ö–æ–¥—ã: credentials"></div>
                                </div>
                            </div>

                            <div class="module-item" draggable="true" data-module="privilege_escalation">
                                <div class="module-icon">
                                    <i class="fas fa-arrow-up"></i>
                                </div>
                                <div class="module-info">
                                    <div class="module-name">–ü–æ–≤—ã—à–µ–Ω–∏–µ –ø—Ä–∏–≤–∏–ª–µ–≥–∏–π</div>
                                    <div class="module-description">–≠—Å–∫–∞–ª–∞—Ü–∏—è –ø—Ä–∞–≤ –≤ —Å–∏—Å—Ç–µ–º–µ</div>
                                </div>
                                <div class="module-ports">
                                    <div class="port input" title="–í—Ö–æ–¥—ã: credentials, system_info"></div>
                                    <div class="port output" title="–í—ã—Ö–æ–¥—ã: elevated_access"></div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Other categories can be added similarly -->
                </div>
            </div>
        </aside>

        <!-- Constructor Canvas -->
        <div class="constructor-canvas" id="constructor-canvas">
            <div class="canvas-header">
                <div class="canvas-tools">
                    <button class="tool-btn" id="select-tool" title="–í—ã–±–æ—Ä" data-tool="select">
                        <i class="fas fa-mouse-pointer"></i>
                    </button>
                    <button class="tool-btn active" id="hand-tool" title="–ü–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ" data-tool="hand">
                        <i class="fas fa-hand-paper"></i>
                    </button>
                    <button class="tool-btn" id="zoom-tool" title="–ú–∞—Å—à—Ç–∞–±" data-tool="zoom">
                        <i class="fas fa-search-plus"></i>
                    </button>
                    <button class="tool-btn" id="connect-tool" title="–°–æ–µ–¥–∏–Ω–µ–Ω–∏–µ" data-tool="connect">
                        <i class="fas fa-link"></i>
                    </button>
                </div>

                <div class="canvas-controls">
                    <div class="zoom-controls">
                        <button class="zoom-btn" id="zoom-out" title="–£–º–µ–Ω—å—à–∏—Ç—å">
                            <i class="fas fa-minus"></i>
                        </button>
                        <span class="zoom-level" id="zoom-level">100%</span>
                        <button class="zoom-btn" id="zoom-in" title="–£–≤–µ–ª–∏—á–∏—Ç—å">
                            <i class="fas fa-plus"></i>
                        </button>
                        <button class="zoom-btn" id="zoom-fit" title="–£–º–µ—Å—Ç–∏—Ç—å –≤—Å–µ">
                            <i class="fas fa-expand"></i>
                        </button>
                    </div>

                    <div class="canvas-actions">
                        <button class="canvas-btn" id="clear-canvas" title="–û—á–∏—Å—Ç–∏—Ç—å —Ö–æ–ª—Å—Ç">
                            <i class="fas fa-trash"></i>
                        </button>
                        <button class="canvas-btn" id="auto-layout" title="–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∫–æ–º–ø–æ–Ω–æ–≤–∫–∞">
                            <i class="fas fa-magic"></i>
                        </button>
                        <button class="canvas-btn" id="fullscreen-canvas" title="–ü–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω—ã–π —Ä–µ–∂–∏–º">
                            <i class="fas fa-expand-arrows-alt"></i>
                        </button>
                    </div>
                </div>
            </div>

            <div class="canvas-workspace" id="canvas-workspace">
                <div class="canvas-grid"></div>
                <div class="canvas-content" id="canvas-content">
                    <!-- Workflow modules will be placed here dynamically -->
                </div>
                <svg class="connection-layer" id="connection-layer">
                    <!-- Connection lines will be drawn here -->
                </svg>
            </div>

            <!-- Canvas Status Bar -->
            <div class="canvas-status">
                <div class="status-info">
                    <span class="modules-count">–ú–æ–¥—É–ª–µ–π: <span id="modules-count">0</span></span>
                    <span class="connections-count">–°–æ–µ–¥–∏–Ω–µ–Ω–∏–π: <span id="connections-count">0</span></span>
                </div>
                <div class="validation-status" id="validation-status">
                    <i class="fas fa-check-circle status-valid"></i>
                    <span>–†–∞–±–æ—á–∏–π –ø—Ä–æ—Ü–µ—Å—Å –≤–∞–ª–∏–¥–µ–Ω</span>
                </div>
            </div>
        </div>

        <!-- Properties Panel -->
        <aside class="properties-panel" id="properties-panel">
            <div class="panel-header">
                <h3 class="panel-title">
                    <i class="fas fa-cog"></i>
                    –°–≤–æ–π—Å—Ç–≤–∞ –º–æ–¥—É–ª—è
                </h3>
                <button class="panel-toggle" id="properties-toggle" title="–°–≤–µ—Ä–Ω—É—Ç—å/—Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—å">
                    <i class="fas fa-chevron-right"></i>
                </button>
            </div>

            <div class="panel-content" id="properties-content">
                <div class="no-selection">
                    <i class="fas fa-info-circle"></i>
                    <p>–í—ã–±–µ—Ä–∏—Ç–µ –º–æ–¥—É–ª—å –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –µ–≥–æ —Å–≤–æ–π—Å—Ç–≤</p>
                </div>
            </div>
        </aside>
    </div>

    <!-- Bottom Panel - Payload Editor -->
    <div class="bottom-panel" id="bottom-panel">
        <div class="panel-tabs">
            <button class="tab-btn active" data-tab="payload-editor">
                <i class="fas fa-code"></i>
                –†–µ–¥–∞–∫—Ç–æ—Ä –ø—ç–π–ª–æ–∞–¥–æ–≤
            </button>
            <button class="tab-btn" data-tab="execution-log">
                <i class="fas fa-terminal"></i>
                –ñ—É—Ä–Ω–∞–ª –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
            </button>
            <button class="tab-btn" data-tab="workflow-validation">
                <i class="fas fa-check-double"></i>
                –í–∞–ª–∏–¥–∞—Ü–∏—è workflow
            </button>
        </div>

        <div class="panel-resize-handle" id="panel-resize-handle"></div>

        <div class="tab-content">
            <!-- Payload Editor Tab -->
            <div class="tab-pane active" id="payload-editor-tab">
                <div class="payload-editor">
                    <div class="editor-header">
                        <h4 class="editor-title">
                            <i class="fas fa-code"></i>
                            –†–µ–¥–∞–∫—Ç–æ—Ä –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏
                        </h4>
                        <div class="editor-actions">
                            <select class="language-select" id="payload-language">
                                <option value="bash">Bash</option>
                                <option value="python">Python</option>
                                <option value="powershell">PowerShell</option>
                                <option value="javascript">JavaScript</option>
                                <option value="sql">SQL</option>
                                <option value="custom">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π</option>
                            </select>
                            <button class="editor-btn" id="format-payload" title="–§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ">
                                <i class="fas fa-indent"></i>
                            </button>
                            <button class="editor-btn" id="validate-payload" title="–í–∞–ª–∏–¥–∞—Ü–∏—è">
                                <i class="fas fa-check"></i>
                            </button>
                            <button class="editor-btn" id="test-payload" title="–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ">
                                <i class="fas fa-play"></i>
                            </button>
                        </div>
                    </div>

                    <div class="editor-body">
                        <textarea class="payload-editor__textarea" id="payload-textarea"
                            placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–∞—à –ø—ç–π–ª–æ–∞–¥ –∑–¥–µ—Å—å...">#!/bin/bash

# –ü—Ä–∏–º–µ—Ä –±–∞–∑–æ–≤–æ–≥–æ –ø—ç–π–ª–æ–∞–¥–∞ –¥–ª—è —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –ø–æ—Ä—Ç–æ–≤
# –¶–µ–ª—å: –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –æ—Ç–∫—Ä—ã—Ç—ã—Ö –ø–æ—Ä—Ç–æ–≤ –Ω–∞ —Ü–µ–ª–µ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ

TARGET_IP="192.168.1.100"
PORTS="22,80,443,3389,5432"

echo "–ù–∞—á–∏–Ω–∞–µ–º —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ—Ä—Ç–æ–≤ –Ω–∞ $TARGET_IP"
echo "–ü–æ—Ä—Ç—ã –¥–ª—è —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è: $PORTS"

for port in $(echo $PORTS | tr "," " "); do
    timeout 3 bash -c "echo >/dev/tcp/$TARGET_IP/$port" 2>/dev/null && 
    echo "–ü–æ—Ä—Ç $port: –û–¢–ö–†–´–¢" || 
    echo "–ü–æ—Ä—Ç $port: –ó–ê–ö–†–´–¢"
done

echo "–°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–æ"</textarea>
                    </div>

                    <div class="editor-footer">
                        <div class="editor-status">
                            <span class="status-text">–ì–æ—Ç–æ–≤</span>
                            <span class="lines-count">–°—Ç—Ä–æ–∫: 15</span>
                            <span class="chars-count">–°–∏–º–≤–æ–ª–æ–≤: 423</span>
                        </div>
                        <div class="editor-controls">
                            <button class="editor-btn" id="clear-payload">
                                <i class="fas fa-trash"></i>
                                –û—á–∏—Å—Ç–∏—Ç—å
                            </button>
                            <button class="editor-btn" id="save-payload">
                                <i class="fas fa-save"></i>
                                –°–æ—Ö—Ä–∞–Ω–∏—Ç—å
                            </button>
                            <button class="editor-btn" id="load-payload">
                                <i class="fas fa-folder-open"></i>
                                –ó–∞–≥—Ä—É–∑–∏—Ç—å
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Execution Log Tab -->
            <div class="tab-pane" id="execution-log-tab">
                <div class="execution-log">
                    <div class="log-header">
                        <h4 class="log-title">
                            <i class="fas fa-terminal"></i>
                            –ñ—É—Ä–Ω–∞–ª –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
                        </h4>
                        <div class="log-controls">
                            <button class="log-btn" id="clear-log" title="–û—á–∏—Å—Ç–∏—Ç—å –∂—É—Ä–Ω–∞–ª">
                                <i class="fas fa-trash"></i>
                            </button>
                            <button class="log-btn" id="export-log" title="–≠–∫—Å–ø–æ—Ä—Ç –∂—É—Ä–Ω–∞–ª–∞">
                                <i class="fas fa-download"></i>
                            </button>
                        </div>
                    </div>
                    <div class="log-content" id="log-content">
                        <div class="log-entry info">
                            <span class="log-time">[2025-02-15 14:30:15]</span>
                            <span class="log-level">INFO</span>
                            <span class="log-message">–ö–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä –∞—Ç–∞–∫ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω</span>
                        </div>
                        <div class="log-entry success">
                            <span class="log-time">[2025-02-15 14:30:16]</span>
                            <span class="log-level">SUCCESS</span>
                            <span class="log-message">–ó–∞–≥—Ä—É–∂–µ–Ω—ã –º–æ–¥—É–ª–∏ –∞—Ç–∞–∫ (25 –º–æ–¥—É–ª–µ–π)</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Workflow Validation Tab -->
            <div class="tab-pane" id="workflow-validation-tab">
                <div class="workflow-validation">
                    <div class="validation-header">
                        <h4 class="validation-title">
                            <i class="fas fa-check-double"></i>
                            –í–∞–ª–∏–¥–∞—Ü–∏—è —Ä–∞–±–æ—á–µ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞
                        </h4>
                        <button class="validation-btn" id="run-validation">
                            <i class="fas fa-play"></i>
                            –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é
                        </button>
                    </div>
                    <div class="validation-results" id="validation-results">
                        <!-- Validation results will be displayed here -->
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Templates for Dynamic Content -->
<script type="text/template" id="workflow-module-template">
    <div class="workflow-module {{moduleType}}" data-module-id="{{id}}" style="left: {{x}}px; top: {{y}}px;">
        <div class="module-header">
            <div class="module-icon">
                <i class="{{iconClass}}"></i>
            </div>
            <div class="module-title">{{name}}</div>
            <div class="module-actions">
                <button class="module-action" data-action="settings" title="–ù–∞—Å—Ç—Ä–æ–π–∫–∏">
                    <i class="fas fa-cog"></i>
                </button>
                <button class="module-action" data-action="delete" title="–£–¥–∞–ª–∏—Ç—å">
                    <i class="fas fa-trash"></i>
                </button>
            </div>
        </div>
        <div class="module-body">
            <div class="module-description">{{description}}</div>
            <div class="module-ports">
                <div class="input-ports">
                    {{#each inputs}}
                    <div class="port input-port" data-port="{{this}}" title="–í—Ö–æ–¥: {{this}}">
                        <div class="port-label">{{this}}</div>
                    </div>
                    {{/each}}
                </div>
                <div class="output-ports">
                    {{#each outputs}}
                    <div class="port output-port" data-port="{{this}}" title="–í—ã—Ö–æ–¥: {{this}}">
                        <div class="port-label">{{this}}</div>
                    </div>
                    {{/each}}
                </div>
            </div>
        </div>
        <div class="module-status">
            <div class="status-indicator {{statusClass}}"></div>
            <div class="status-text">{{statusText}}</div>
        </div>
    </div>
</script>

<script type="text/template" id="module-settings-template">
    <div class="module-settings">
        <div class="settings-header">
            <h4>–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –º–æ–¥—É–ª—è: {{moduleName}}</h4>
        </div>
        <div class="settings-body">
            {{#each settings}}
            <div class="setting-item">
                <label class="setting-label">{{label}}</label>
                {{#if (eq type 'text')}}
                <input type="text" class="setting-input" name="{{key}}" value="{{default}}" {{#if required}}required{{/if}}>
                {{/if}}
                {{#if (eq type 'number')}}
                <input type="number" class="setting-input" name="{{key}}" value="{{default}}" min="{{min}}" max="{{max}}" {{#if required}}required{{/if}}>
                {{/if}}
                {{#if (eq type 'checkbox')}}
                <input type="checkbox" class="setting-checkbox" name="{{key}}" {{#if default}}checked{{/if}}>
                {{/if}}
                {{#if (eq type 'select')}}
                <select class="setting-select" name="{{key}}">
                    {{#each options}}
                    <option value="{{this}}" {{#if (eq this ../default)}}selected{{/if}}>{{this}}</option>
                    {{/each}}
                </select>
                {{/if}}
            </div>
            {{/each}}
        </div>
        <div class="settings-footer">
            <button class="btn btn--secondary" onclick="closeSettings()">–û—Ç–º–µ–Ω–∞</button>
            <button class="btn btn--primary" onclick="saveSettings()">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
        </div>
    </div>
</script>

<!-- Enhanced JavaScript Initialization -->
<script src="../attack-constructor/exploit-library.js" defer></script>
<script src="../attack-constructor/attack-builder.js" defer></script>
<script src="../attack-constructor/AttackModuleConstructor.js" defer></script>

<script>
    document.addEventListener('DOMContentLoaded', () => {
        console.log('üî® Initializing Attack Constructor Module');

        // Initialize Enhanced Attack Module Constructor with full capabilities
        const attackConstructor = new AttackModuleConstructor('attack-constructor', {
            theme: 'dark',
            readOnly: false,
            showLibrary: true,
            showProperties: true,
            enableDragDrop: true,
            enableConnections: true,
            enableValidation: true,
            enableExport: true,
            autoSave: true,
            maxModules: 50,
            onModuleAdd: (module) => {
                console.log('üì¶ Module added:', module);
                updateWorkflowStats();
            },
            onModuleRemove: (moduleId) => {
                console.log('üóëÔ∏è Module removed:', moduleId);
                updateWorkflowStats();
            },
            onConnectionCreate: (connection) => {
                console.log('üîó Connection created:', connection);
                validateWorkflow();
            },
            onWorkflowChange: (workflow) => {
                console.log('üîÑ Workflow changed:', workflow);
                autoSaveWorkflow(workflow);
            },
            onError: (error) => {
                console.error('‚ùå Constructor error:', error);
                showErrorNotification(error.message);
            }
        });

        // Initialize Enhanced Exploit Library
        const exploitLibrary = new ExploitLibrary('module-library', {
            showSearch: true,
            showCategories: true,
            itemsPerPage: 20,
            enableFiltering: true,
            enableDragDrop: true,
            onModuleSelect: (module) => {
                console.log('üìã Module selected:', module);
                showModuleDetails(module);
            },
            onModuleDrag: (module, event) => {
                console.log('üéØ Module drag started:', module);
                handleModuleDragStart(module, event);
            }
        });

        // Initialize Enhanced Attack Builder
        const attackBuilder = new AttackBuilder('constructor-canvas', {
            readOnly: false,
            showLibrary: true,
            showProperties: true,
            enableDragDrop: true,
            enableZoom: true,
            enableGrid: true,
            enableSnapping: true,
            gridSize: 20,
            maxZoom: 300,
            minZoom: 25,
            onCanvasChange: (state) => {
                console.log('üé® Canvas changed:', state);
                updateCanvasStatus(state);
            },
            onModulePlace: (module, position) => {
                console.log('üìç Module placed:', module, position);
                addModuleToWorkflow(module, position);
            }
        });

        // Setup enhanced event handlers
        setupEnhancedEventHandlers();

        // Setup drag & drop functionality
        setupDragDropHandlers();

        // Setup payload editor
        setupPayloadEditor();

        // Setup workflow validation
        setupWorkflowValidation();

        // Setup export functionality
        setupExportFunctionality();

        // Setup auto-save
        setupAutoSave();

        // Setup keyboard shortcuts
        setupKeyboardShortcuts();

        // Load default template
        loadWorkflowTemplate('basic_pentest');
    });

    // Enhanced event handlers
    function setupEnhancedEventHandlers() {
        // Workflow template selector
        document.getElementById('workflow-template').addEventListener('change', (e) => {
            if (e.target.value) {
                loadWorkflowTemplate(e.target.value);
            }
        });

        // Action buttons
        document.getElementById('validate-workflow').addEventListener('click', validateWorkflow);
        document.getElementById('test-workflow').addEventListener('click', testWorkflow);
        document.getElementById('save-workflow').addEventListener('click', saveWorkflow);
        document.getElementById('export-workflow').addEventListener('click', exportWorkflow);

        // Library toggle
        document.getElementById('library-toggle').addEventListener('click', toggleLibrary);
        document.getElementById('properties-toggle').addEventListener('click', toggleProperties);

        // Canvas tools
        document.querySelectorAll('.tool-btn').forEach(btn => {
            btn.addEventListener('click', (e) => {
                const tool = e.target.closest('.tool-btn').dataset.tool;
                selectCanvasTool(tool);
            });
        });

        // Zoom controls
        document.getElementById('zoom-in').addEventListener('click', () => zoomCanvas(1.2));
        document.getElementById('zoom-out').addEventListener('click', () => zoomCanvas(0.8));
        document.getElementById('zoom-fit').addEventListener('click', fitToCanvas);

        // Canvas actions
        document.getElementById('clear-canvas').addEventListener('click', clearCanvas);
        document.getElementById('auto-layout').addEventListener('click', autoLayoutModules);
        document.getElementById('fullscreen-canvas').addEventListener('click', toggleFullscreen);

        // Tab switching
        document.querySelectorAll('.tab-btn').forEach(btn => {
            btn.addEventListener('click', (e) => {
                const tab = e.target.closest('.tab-btn').dataset.tab;
                switchTab(tab);
            });
        });

        // Category toggles
        window.toggleCategory = (categoryId) => {
            const section = document.querySelector(`[data-category="${categoryId}"]`);
            section.classList.toggle('collapsed');
        };
    }

    // Drag & Drop handlers
    function setupDragDropHandlers() {
        const canvas = document.getElementById('canvas-content');

        // Handle module drag from library
        document.querySelectorAll('.module-item').forEach(item => {
            item.addEventListener('dragstart', (e) => {
                const moduleId = e.target.closest('.module-item').dataset.module;
                e.dataTransfer.setData('text/plain', moduleId);
                e.dataTransfer.effectAllowed = 'copy';
            });
        });

        // Handle drop on canvas
        canvas.addEventListener('dragover', (e) => {
            e.preventDefault();
            e.dataTransfer.dropEffect = 'copy';
        });

        canvas.addEventListener('drop', (e) => {
            e.preventDefault();
            const moduleId = e.dataTransfer.getData('text/plain');
            const rect = canvas.getBoundingClientRect();
            const x = e.clientX - rect.left;
            const y = e.clientY - rect.top;

            addModuleToCanvas(moduleId, { x, y });
        });
    }

    // Payload editor setup
    function setupPayloadEditor() {
        const textarea = document.getElementById('payload-textarea');
        const languageSelect = document.getElementById('payload-language');

        // Language change handler
        languageSelect.addEventListener('change', (e) => {
            updatePayloadSyntax(e.target.value);
        });

        // Payload validation
        document.getElementById('validate-payload').addEventListener('click', validatePayload);
        document.getElementById('test-payload').addEventListener('click', testPayload);
        document.getElementById('format-payload').addEventListener('click', formatPayload);

        // Auto-update stats
        textarea.addEventListener('input', updatePayloadStats);
    }

    // Workflow validation setup
    function setupWorkflowValidation() {
        document.getElementById('run-validation').addEventListener('click', () => {
            runWorkflowValidation();
        });
    }

    // Export functionality
    function setupExportFunctionality() {
        const exportFormats = ['json', 'xml', 'yaml', 'python', 'bash'];

        exportFormats.forEach(format => {
            document.addEventListener(`export-${format}`, () => {
                exportWorkflowAs(format);
            });
        });
    }

    // Auto-save functionality
    function setupAutoSave() {
        let autoSaveTimer;
        const autoSaveInterval = 30000; // 30 seconds

        function triggerAutoSave() {
            clearTimeout(autoSaveTimer);
            autoSaveTimer = setTimeout(() => {
                autoSaveWorkflow();
            }, autoSaveInterval);
        }

        // Trigger auto-save on workflow changes
        document.addEventListener('workflow-changed', triggerAutoSave);
    }

    // Keyboard shortcuts
    function setupKeyboardShortcuts() {
        document.addEventListener('keydown', (e) => {
            if (e.ctrlKey || e.metaKey) {
                switch (e.key) {
                    case 's':
                        e.preventDefault();
                        saveWorkflow();
                        break;
                    case 'z':
                        e.preventDefault();
                        if (e.shiftKey) {
                            redoAction();
                        } else {
                            undoAction();
                        }
                        break;
                    case 'a':
                        e.preventDefault();
                        selectAllModules();
                        break;
                    case 'c':
                        e.preventDefault();
                        copySelectedModules();
                        break;
                    case 'v':
                        e.preventDefault();
                        pasteModules();
                        break;
                    case 'd':
                        e.preventDefault();
                        duplicateSelectedModules();
                        break;
                }
            }

            // Delete key
            if (e.key === 'Delete') {
                deleteSelectedModules();
            }

            // Escape key
            if (e.key === 'Escape') {
                deselectAllModules();
                closeModals();
            }
        });
    }

    // Implementation functions
    function loadWorkflowTemplate(templateId) {
        console.log('üìã Loading workflow template:', templateId);
        // Template loading logic
    }

    function addModuleToCanvas(moduleId, position) {
        console.log('üì¶ Adding module to canvas:', moduleId, position);
        // Module placement logic
    }

    function validateWorkflow() {
        console.log('‚úÖ Validating workflow');
        // Validation logic
    }

    function testWorkflow() {
        console.log('üß™ Testing workflow');
        // Test execution logic
    }

    function saveWorkflow() {
        console.log('üíæ Saving workflow');
        // Save logic
    }

    function exportWorkflow() {
        console.log('üì§ Exporting workflow');
        // Export logic
    }

    function updateWorkflowStats() {
        const modulesCount = document.querySelectorAll('.workflow-module').length;
        const connectionsCount = document.querySelectorAll('.connection-line').length;

        document.getElementById('modules-count').textContent = modulesCount;
        document.getElementById('connections-count').textContent = connectionsCount;
    }

    function updatePayloadStats() {
        const textarea = document.getElementById('payload-textarea');
        const lines = textarea.value.split('\n').length;
        const chars = textarea.value.length;

        document.querySelector('.lines-count').textContent = `–°—Ç—Ä–æ–∫: ${lines}`;
        document.querySelector('.chars-count').textContent = `–°–∏–º–≤–æ–ª–æ–≤: ${chars}`;
    }

    // Placeholder functions for advanced features
    function toggleLibrary() { console.log('üìö Toggle library'); }
    function toggleProperties() { console.log('‚öôÔ∏è Toggle properties'); }
    function selectCanvasTool(tool) { console.log('üîß Select tool:', tool); }
    function zoomCanvas(factor) { console.log('üîç Zoom canvas:', factor); }
    function fitToCanvas() { console.log('üìê Fit to canvas'); }
    function clearCanvas() { console.log('üßπ Clear canvas'); }
    function autoLayoutModules() { console.log('‚ú® Auto layout'); }
    function toggleFullscreen() { console.log('üñ•Ô∏è Toggle fullscreen'); }
    function switchTab(tab) { console.log('üìë Switch tab:', tab); }
    function validatePayload() { console.log('‚úÖ Validate payload'); }
    function testPayload() { console.log('üß™ Test payload'); }
    function formatPayload() { console.log('üé® Format payload'); }
    function runWorkflowValidation() { console.log('üîç Run validation'); }
    function exportWorkflowAs(format) { console.log('üì§ Export as:', format); }
    function autoSaveWorkflow() { console.log('üíæ Auto save'); }
    function undoAction() { console.log('‚Ü∂ Undo'); }
    function redoAction() { console.log('‚Ü∑ Redo'); }
    function selectAllModules() { console.log('üéØ Select all'); }
    function copySelectedModules() { console.log('üìã Copy'); }
    function pasteModules() { console.log('üìå Paste'); }
    function duplicateSelectedModules() { console.log('üì¶ Duplicate'); }
    function deleteSelectedModules() { console.log('üóëÔ∏è Delete'); }
    function deselectAllModules() { console.log('‚ùå Deselect all'); }
    function closeModals() { console.log('üö™ Close modals'); }
    function showModuleDetails(module) { console.log('üìÑ Show details:', module); }
    function handleModuleDragStart(module, event) { console.log('üéØ Drag start:', module); }
    function updateCanvasStatus(state) { console.log('üìä Canvas status:', state); }
    function addModuleToWorkflow(module, position) { console.log('‚ûï Add to workflow:', module, position); }
    function updatePayloadSyntax(language) { console.log('üé® Update syntax:', language); }
    function showErrorNotification(message) { console.log('‚ùå Error:', message); }
</script>

<style>
    /* Additional enhanced styles for attack constructor */
    .attack-constructor {
        display: flex;
        flex-direction: column;
        height: 100vh;
        background: var(--color-background);
        color: var(--color-text);
    }

    .constructor-header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: var(--space-16) var(--space-24);
        background: var(--color-surface);
        border-bottom: 1px solid var(--color-border);
    }

    .constructor-title {
        display: flex;
        align-items: center;
        gap: var(--space-12);
        font-size: var(--font-size-2xl);
        font-weight: var(--font-weight-bold);
        color: var(--color-text);
        margin: 0;
    }

    .constructor-title i {
        color: var(--color-primary);
    }

    .workflow-info {
        display: flex;
        flex-direction: column;
        gap: var(--space-4);
    }

    .workflow-name {
        font-size: var(--font-size-lg);
        font-weight: var(--font-weight-semibold);
        color: var(--color-text);
    }

    .workflow-status {
        display: flex;
        align-items: center;
        gap: var(--space-6);
        font-size: var(--font-size-sm);
        color: var(--color-text-secondary);
    }

    .status-indicator {
        width: var(--space-8);
        height: var(--space-8);
        border-radius: 50%;
    }

    .status-indicator.status-draft {
        background: var(--color-warning);
    }

    .status-indicator.status-valid {
        background: var(--color-success);
    }

    .status-indicator.status-invalid {
        background: var(--color-error);
    }

    .constructor-main {
        display: flex;
        flex: 1;
        overflow: hidden;
    }

    .module-library {
        width: 320px;
        background: var(--color-surface);
        border-right: 1px solid var(--color-border);
        display: flex;
        flex-direction: column;
        transition: width var(--duration-normal) var(--ease-standard);
    }

    .module-library.collapsed {
        width: 48px;
    }

    .library-header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: var(--space-16);
        border-bottom: 1px solid var(--color-border);
    }

    .library-title {
        display: flex;
        align-items: center;
        gap: var(--space-8);
        font-size: var(--font-size-lg);
        font-weight: var(--font-weight-semibold);
        margin: 0;
    }

    .category-section {
        border-bottom: 1px solid var(--color-border);
    }

    .category-header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: var(--space-12) var(--space-16);
        cursor: pointer;
        transition: background var(--duration-fast) var(--ease-standard);
    }

    .category-header:hover {
        background: var(--color-secondary);
    }

    .category-title {
        display: flex;
        align-items: center;
        gap: var(--space-8);
        font-size: var(--font-size-base);
        font-weight: var(--font-weight-semibold);
        margin: 0;
    }

    .category-count {
        background: var(--color-primary);
        color: var(--color-btn-primary-text);
        padding: var(--space-2) var(--space-6);
        border-radius: var(--radius-full);
        font-size: var(--font-size-xs);
        font-weight: var(--font-weight-bold);
    }

    .category-modules {
        padding: var(--space-8);
    }

    .category-section.collapsed .category-modules {
        display: none;
    }

    .module-item {
        display: flex;
        align-items: center;
        gap: var(--space-12);
        padding: var(--space-8);
        margin-bottom: var(--space-8);
        background: var(--color-background);
        border: 1px solid var(--color-border);
        border-radius: var(--radius-base);
        cursor: grab;
        transition: all var(--duration-fast) var(--ease-standard);
    }

    .module-item:hover {
        border-color: var(--color-primary);
        box-shadow: 0 2px 8px rgba(var(--color-primary-rgb), 0.2);
    }

    .module-item:active {
        cursor: grabbing;
    }

    .module-icon {
        display: flex;
        align-items: center;
        justify-content: center;
        width: 32px;
        height: 32px;
        background: var(--color-primary);
        color: var(--color-btn-primary-text);
        border-radius: var(--radius-base);
        font-size: var(--font-size-sm);
    }

    .module-info {
        flex: 1;
    }

    .module-name {
        font-size: var(--font-size-sm);
        font-weight: var(--font-weight-semibold);
        color: var(--color-text);
        margin-bottom: var(--space-2);
    }

    .module-description {
        font-size: var(--font-size-xs);
        color: var(--color-text-secondary);
        line-height: var(--line-height-tight);
    }

    .module-ports {
        display: flex;
        flex-direction: column;
        gap: var(--space-4);
    }

    .port {
        width: var(--space-8);
        height: var(--space-8);
        border-radius: 50%;
        border: 2px solid var(--color-border);
        transition: border-color var(--duration-fast) var(--ease-standard);
    }

    .port.input {
        background: var(--color-info);
    }

    .port.output {
        background: var(--color-success);
    }

    .constructor-canvas {
        flex: 1;
        display: flex;
        flex-direction: column;
        background: var(--color-background);
    }

    .canvas-header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: var(--space-12) var(--space-16);
        background: var(--color-surface);
        border-bottom: 1px solid var(--color-border);
    }

    .canvas-tools {
        display: flex;
        gap: var(--space-4);
    }

    .tool-btn {
        display: flex;
        align-items: center;
        justify-content: center;
        width: 36px;
        height: 36px;
        background: transparent;
        border: 1px solid var(--color-border);
        border-radius: var(--radius-base);
        color: var(--color-text-secondary);
        cursor: pointer;
        transition: all var(--duration-fast) var(--ease-standard);
    }

    .tool-btn:hover {
        background: var(--color-secondary);
        color: var(--color-text);
    }

    .tool-btn.active {
        background: var(--color-primary);
        color: var(--color-btn-primary-text);
        border-color: var(--color-primary);
    }

    .canvas-workspace {
        flex: 1;
        position: relative;
        overflow: hidden;
        background: var(--color-background);
    }

    .canvas-grid {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-image:
            linear-gradient(rgba(var(--color-border-rgb), 0.1) 1px, transparent 1px),
            linear-gradient(90deg, rgba(var(--color-border-rgb), 0.1) 1px, transparent 1px);
        background-size: 20px 20px;
        pointer-events: none;
    }

    .canvas-content {
        position: relative;
        width: 100%;
        height: 100%;
    }

    .connection-layer {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        pointer-events: none;
        z-index: 1;
    }

    .workflow-module {
        position: absolute;
        min-width: 200px;
        background: var(--color-surface);
        border: 2px solid var(--color-border);
        border-radius: var(--radius-lg);
        box-shadow: var(--shadow-md);
        cursor: move;
        transition: all var(--duration-fast) var(--ease-standard);
        z-index: 2;
    }

    .workflow-module:hover {
        border-color: var(--color-primary);
        box-shadow: var(--shadow-lg);
    }

    .workflow-module.selected {
        border-color: var(--color-warning);
        box-shadow: 0 0 0 3px rgba(var(--color-warning-rgb), 0.3);
    }

    .bottom-panel {
        height: 300px;
        background: var(--color-surface);
        border-top: 1px solid var(--color-border);
        display: flex;
        flex-direction: column;
        transition: height var(--duration-normal) var(--ease-standard);
    }

    .panel-tabs {
        display: flex;
        border-bottom: 1px solid var(--color-border);
    }

    .tab-btn {
        display: flex;
        align-items: center;
        gap: var(--space-8);
        padding: var(--space-12) var(--space-16);
        background: transparent;
        border: none;
        border-bottom: 2px solid transparent;
        color: var(--color-text-secondary);
        cursor: pointer;
        transition: all var(--duration-fast) var(--ease-standard);
    }

    .tab-btn:hover {
        color: var(--color-text);
        background: var(--color-secondary);
    }

    .tab-btn.active {
        color: var(--color-primary);
        border-bottom-color: var(--color-primary);
    }

    .payload-editor__textarea {
        width: 100%;
        height: 200px;
        padding: var(--space-16);
        background: var(--color-background);
        border: 1px solid var(--color-border);
        border-radius: var(--radius-base);
        color: var(--color-text);
        font-family: var(--font-family-mono);
        font-size: var(--font-size-sm);
        line-height: var(--line-height-normal);
        resize: vertical;
    }

    .canvas-status {
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: var(--space-8) var(--space-16);
        background: var(--color-surface);
        border-top: 1px solid var(--color-border);
        font-size: var(--font-size-sm);
    }

    .status-info {
        display: flex;
        gap: var(--space-16);
        color: var(--color-text-secondary);
    }

    .validation-status {
        display: flex;
        align-items: center;
        gap: var(--space-6);
        color: var(--color-success);
    }

    /* Animation for drag and drop */
    @keyframes module-drop {
        0% {
            transform: scale(0.8);
            opacity: 0.8;
        }

        100% {
            transform: scale(1);
            opacity: 1;
        }
    }

    .workflow-module.just-added {
        animation: module-drop 0.3s ease-out;
    }

    /* Responsive design */
    @media (max-width: 1024px) {
        .module-library {
            width: 280px;
        }

        .properties-panel {
            width: 280px;
        }
    }

    @media (max-width: 768px) {
        .constructor-header {
            flex-direction: column;
            gap: var(--space-12);
        }

        .module-library {
            width: 240px;
        }

        .bottom-panel {
            height: 250px;
        }
    }
</style>