<!-- pages/scanner.html -->
<!-- Advanced Scanner module for IP Roast Enterprise 4.0 -->
<!-- Enhanced with full functionality from scanner folder -->

<!-- All Scanner Styles -->
<link rel="stylesheet" href="../scanner/scanner.css">
<link rel="stylesheet" href="../scanner/scan-form.css">
<link rel="stylesheet" href="../scanner/scan-results.css">
<link rel="stylesheet" href="../scanner/port-scanner.css">

<!-- Scanner Container -->
<div class="scanner" id="scanner-container">

    <!-- Scanner Header -->
    <header class="scanner-header">
        <div class="header-left">
            <div class="title-section">
                <h1 class="scanner-title">
                    <i class="fas fa-search"></i>
                    –°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–µ—Ç–∏
                </h1>
                <p class="scanner-subtitle">–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤ –∏ –∞–Ω–∞–ª–∏–∑ –ø–æ—Ä—Ç–æ–≤</p>
            </div>

            <!-- Scanner Statistics -->
            <div class="scanner-stats">
                <div class="stat-item">
                    <i class="fas fa-network-wired"></i>
                    <span class="stat-value" id="total-scans">247</span>
                    <span class="stat-label">–í—Å–µ–≥–æ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–π</span>
                </div>
                <div class="stat-item">
                    <i class="fas fa-desktop"></i>
                    <span class="stat-value" id="discovered-hosts">1,429</span>
                    <span class="stat-label">–ù–∞–π–¥–µ–Ω–æ —Ö–æ—Å—Ç–æ–≤</span>
                </div>
                <div class="stat-item">
                    <i class="fas fa-door-open"></i>
                    <span class="stat-value" id="open-ports">12,847</span>
                    <span class="stat-label">–û—Ç–∫—Ä—ã—Ç—ã—Ö –ø–æ—Ä—Ç–æ–≤</span>
                </div>
                <div class="stat-item">
                    <i class="fas fa-clock"></i>
                    <span class="stat-value" id="avg-scan-time">2.4</span>
                    <span class="stat-label">–ú–∏–Ω. —Å—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è</span>
                </div>
            </div>
        </div>

        <div class="header-controls">
            <!-- Quick Actions -->
            <div class="quick-actions">
                <button class="quick-action-btn" id="quick-scan-local" title="–ë—ã—Å—Ç—Ä–æ–µ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –ª–æ–∫–∞–ª—å–Ω–æ–π —Å–µ—Ç–∏">
                    <i class="fas fa-home"></i>
                    <span>–õ–æ–∫–∞–ª—å–Ω–∞—è —Å–µ—Ç—å</span>
                </button>
                <button class="quick-action-btn" id="import-targets" title="–ò–º–ø–æ—Ä—Ç —Å–ø–∏—Å–∫–∞ —Ü–µ–ª–µ–π">
                    <i class="fas fa-upload"></i>
                    <span>–ò–º–ø–æ—Ä—Ç</span>
                </button>
                <button class="quick-action-btn" id="scan-history" title="–ò—Å—Ç–æ—Ä–∏—è —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–π">
                    <i class="fas fa-history"></i>
                    <span>–ò—Å—Ç–æ—Ä–∏—è</span>
                </button>
            </div>
        </div>
    </header>

    <!-- Scanner Form Area -->
    <div class="scanner__form-area">
        <!-- Scan Configuration Form -->
        <div class="scan-form" id="scan-form">
            <div class="scan-form__header">
                <h3 class="scan-form__title">–ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è</h3>
                <div class="form-mode-selector">
                    <button class="mode-btn active" data-mode="basic" title="–ë–∞–∑–æ–≤—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏">
                        <i class="fas fa-layer-group"></i>
                        –ë–∞–∑–æ–≤—ã–π
                    </button>
                    <button class="mode-btn" data-mode="advanced" title="–†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏">
                        <i class="fas fa-cogs"></i>
                        –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π
                    </button>
                    <button class="mode-btn" data-mode="custom" title="–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏">
                        <i class="fas fa-code"></i>
                        –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π
                    </button>
                </div>
            </div>

            <div class="scan-form__body">
                <!-- Basic Mode Configuration -->
                <div class="form-mode active" id="basic-mode">
                    <div class="form-row">
                        <div class="scan-form__group">
                            <label class="scan-form__label" for="target-input">
                                <i class="fas fa-bullseye"></i>
                                –¶–µ–ª–µ–≤–∞—è —Å–µ—Ç—å –∏–ª–∏ IP –∞–¥—Ä–µ—Å
                            </label>
                            <div class="input-with-validation">
                                <input type="text" class="scan-form__input scan-form__input--target" id="target-input"
                                    placeholder="192.168.1.0/24, 10.0.0.1, example.com" autocomplete="off">
                                <div class="input-status" id="target-status"></div>
                            </div>
                            <div class="scan-form__error scan-form__error--target" id="target-error"></div>
                        </div>

                        <div class="scan-form__group">
                            <label class="scan-form__label" for="scan-type">
                                <i class="fas fa-search-plus"></i>
                                –¢–∏–ø —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
                            </label>
                            <select class="scan-form__select" id="scan-type">
                                <option value="ping_sweep">Ping Sweep (–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ —Ö–æ—Å—Ç–æ–≤)</option>
                                <option value="port_scan" selected>Port Scan (–°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ—Ä—Ç–æ–≤)</option>
                                <option value="service_detection">Service Detection (–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–æ–≤)</option>
                                <option value="vulnerability_scan">Vulnerability Scan (–ü–æ–∏—Å–∫ —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π)</option>
                                <option value="comprehensive">Comprehensive Scan (–ü–æ–ª–Ω–æ–µ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ)</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="scan-form__group">
                            <label class="scan-form__label" for="ports-input">
                                <i class="fas fa-door-open"></i>
                                –ü–æ—Ä—Ç—ã –¥–ª—è —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
                            </label>
                            <div class="ports-input-container">
                                <input type="text" class="scan-form__input scan-form__input--ports" id="ports-input"
                                    value="80,443,22,21,25,53,110,993,995,143"
                                    placeholder="80,443,22,21,25,53 –∏–ª–∏ 1-1000 –∏–ª–∏ all">
                                <button class="ports-preset-btn" id="ports-preset" title="–ü–æ–ø—É–ª—è—Ä–Ω—ã–µ –ø–æ—Ä—Ç—ã">
                                    <i class="fas fa-list"></i>
                                </button>
                            </div>
                            <div class="scan-form__error scan-form__error--ports" id="ports-error"></div>
                        </div>

                        <div class="scan-form__group">
                            <label class="scan-form__label" for="scan-speed">
                                <i class="fas fa-tachometer-alt"></i>
                                –°–∫–æ—Ä–æ—Å—Ç—å —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
                            </label>
                            <div class="speed-selector">
                                <input type="range" class="speed-slider" id="scan-speed" min="1" max="5" value="3">
                                <div class="speed-labels">
                                    <span>–ú–µ–¥–ª–µ–Ω–Ω–æ</span>
                                    <span class="active">–ù–æ—Ä–º–∞–ª—å–Ω–æ</span>
                                    <span>–ë—ã—Å—Ç—Ä–æ</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Advanced Mode Configuration -->
                <div class="form-mode" id="advanced-mode">
                    <div class="advanced-grid">
                        <div class="advanced-section">
                            <h4 class="section-title">
                                <i class="fas fa-network-wired"></i>
                                –ü–∞—Ä–∞–º–µ—Ç—Ä—ã —Å–µ—Ç–∏
                            </h4>

                            <div class="scan-form__group">
                                <label class="scan-form__label" for="timeout">–¢–∞–π–º–∞—É—Ç (–º—Å)</label>
                                <input type="number" class="scan-form__input scan-form__input--small" id="timeout"
                                    value="5000" min="100" max="60000">
                            </div>

                            <div class="scan-form__group">
                                <label class="scan-form__label" for="threads">–ü–æ—Ç–æ–∫–∏</label>
                                <input type="number" class="scan-form__input scan-form__input--small" id="threads"
                                    value="50" min="1" max="1000">
                            </div>

                            <div class="scan-form__group">
                                <label class="scan-form__label" for="delay">–ó–∞–¥–µ—Ä–∂–∫–∞ –º–µ–∂–¥—É –∑–∞–ø—Ä–æ—Å–∞–º–∏ (–º—Å)</label>
                                <input type="number" class="scan-form__input scan-form__input--small" id="delay"
                                    value="0" min="0" max="10000">
                            </div>

                            <div class="scan-form__group">
                                <label class="scan-form__label" for="retries">–ü–æ–≤—Ç–æ—Ä–Ω—ã–µ –ø–æ–ø—ã—Ç–∫–∏</label>
                                <input type="number" class="scan-form__input scan-form__input--small" id="retries"
                                    value="2" min="0" max="10">
                            </div>
                        </div>

                        <div class="advanced-section">
                            <h4 class="section-title">
                                <i class="fas fa-shield-alt"></i>
                                Evasion —Ç–µ—Ö–Ω–∏–∫–∏
                            </h4>

                            <div class="scan-form__options">
                                <div class="scan-form__option">
                                    <input type="checkbox" class="scan-form__checkbox" id="randomize-order">
                                    <label class="scan-form__option-label" for="randomize-order">–°–ª—É—á–∞–π–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫
                                        —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è</label>
                                </div>

                                <div class="scan-form__option">
                                    <input type="checkbox" class="scan-form__checkbox" id="fragment-packets">
                                    <label class="scan-form__option-label" for="fragment-packets">–§—Ä–∞–≥–º–µ–Ω—Ç–∞—Ü–∏—è
                                        –ø–∞–∫–µ—Ç–æ–≤</label>
                                </div>

                                <div class="scan-form__option">
                                    <input type="checkbox" class="scan-form__checkbox" id="spoof-source">
                                    <label class="scan-form__option-label" for="spoof-source">–ü–æ–¥–º–µ–Ω–∞ source IP</label>
                                </div>

                                <div class="scan-form__option">
                                    <input type="checkbox" class="scan-form__checkbox" id="use-proxy">
                                    <label class="scan-form__option-label" for="use-proxy">–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–æ–∫—Å–∏</label>
                                </div>
                            </div>
                        </div>

                        <div class="advanced-section">
                            <h4 class="section-title">
                                <i class="fas fa-cog"></i>
                                –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –æ–ø—Ü–∏–∏
                            </h4>

                            <div class="scan-form__options">
                                <div class="scan-form__option">
                                    <input type="checkbox" class="scan-form__checkbox" id="os-detection" checked>
                                    <label class="scan-form__option-label" for="os-detection">–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –û–°</label>
                                </div>

                                <div class="scan-form__option">
                                    <input type="checkbox" class="scan-form__checkbox" id="version-detection" checked>
                                    <label class="scan-form__option-label" for="version-detection">–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ
                                        –≤–µ—Ä—Å–∏–π</label>
                                </div>

                                <div class="scan-form__option">
                                    <input type="checkbox" class="scan-form__checkbox" id="script-scan">
                                    <label class="scan-form__option-label" for="script-scan">NSE —Å–∫—Ä–∏–ø—Ç—ã</label>
                                </div>

                                <div class="scan-form__option">
                                    <input type="checkbox" class="scan-form__checkbox" id="aggressive-timing">
                                    <label class="scan-form__option-label" for="aggressive-timing">–ê–≥—Ä–µ—Å—Å–∏–≤–Ω–æ–µ
                                        —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ</label>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Custom Mode Configuration -->
                <div class="form-mode" id="custom-mode">
                    <div class="custom-config">
                        <div class="scan-form__group">
                            <label class="scan-form__label" for="custom-command">
                                <i class="fas fa-terminal"></i>
                                –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∞—è –∫–æ–º–∞–Ω–¥–∞ Nmap
                            </label>
                            <textarea class="scan-form__textarea" id="custom-command" rows="4"
                                placeholder="nmap -sS -O -sV --script vuln 192.168.1.0/24"></textarea>
                            <div class="command-help">
                                <small>–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è –≤—Å–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –æ–ø—Ü–∏–∏ Nmap. <a href="#" id="nmap-help">–°–ø—Ä–∞–≤–∫–∞ –ø–æ
                                        –∫–æ–º–∞–Ω–¥–∞–º</a></small>
                            </div>
                        </div>

                        <div class="command-builder">
                            <h4>–ö–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä –∫–æ–º–∞–Ω–¥</h4>
                            <div class="builder-options">
                                <div class="builder-group">
                                    <label>–¢–∏–ø —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è:</label>
                                    <select class="builder-select" data-param="-s">
                                        <option value="">–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é</option>
                                        <option value="S">TCP SYN (-sS)</option>
                                        <option value="T">TCP Connect (-sT)</option>
                                        <option value="U">UDP (-sU)</option>
                                        <option value="A">ACK (-sA)</option>
                                        <option value="W">Window (-sW)</option>
                                        <option value="F">FIN (-sF)</option>
                                        <option value="X">Xmas (-sX)</option>
                                        <option value="N">Null (-sN)</option>
                                    </select>
                                </div>

                                <div class="builder-group">
                                    <label>Timing:</label>
                                    <select class="builder-select" data-param="-T">
                                        <option value="">–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é</option>
                                        <option value="0">Paranoid (-T0)</option>
                                        <option value="1">Sneaky (-T1)</option>
                                        <option value="2">Polite (-T2)</option>
                                        <option value="3" selected>Normal (-T3)</option>
                                        <option value="4">Aggressive (-T4)</option>
                                        <option value="5">Insane (-T5)</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Form Actions -->
            <div class="scan-form__actions">
                <button class="scan-form__btn scan-form__btn--secondary" data-action="reset" id="reset-form">
                    <i class="fas fa-undo"></i>
                    –°–±—Ä–æ—Å–∏—Ç—å
                </button>
                <button class="scan-form__btn scan-form__btn--secondary" id="save-preset">
                    <i class="fas fa-save"></i>
                    –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –ø—Ä–µ—Å–µ—Ç
                </button>
                <button class="scan-form__btn scan-form__btn--primary" data-action="start" id="start-scan">
                    <i class="fas fa-play"></i>
                    <span class="btn-text">–ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ</span>
                    <div class="scan-form__loading" id="scan-loading" style="display: none;">
                        <div class="scan-form__spinner"></div>
                    </div>
                </button>
            </div>
        </div>
    </div>

    <!-- Scanner Results Area -->
    <div class="scanner__results-area">
        <!-- Scan Progress -->
        <div class="scan-progress" id="scan-progress" style="display: none;">
            <div class="progress-header">
                <h3 class="progress-title">
                    <i class="fas fa-spinner fa-spin"></i>
                    –°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ...
                </h3>
                <div class="progress-controls">
                    <button class="progress-btn" id="pause-scan" title="–ü—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å">
                        <i class="fas fa-pause"></i>
                    </button>
                    <button class="progress-btn" id="stop-scan" title="–û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å">
                        <i class="fas fa-stop"></i>
                    </button>
                </div>
            </div>

            <div class="progress-content">
                <div class="progress-bar">
                    <div class="progress-fill" id="progress-fill" style="width: 0%"></div>
                    <div class="progress-text">
                        <span id="progress-percent">0%</span>
                        <span id="progress-eta">–†–∞—Å—á–µ—Ç –≤—Ä–µ–º–µ–Ω–∏...</span>
                    </div>
                </div>

                <div class="scan-details">
                    <div class="detail-item">
                        <span class="detail-label">–¢–µ–∫—É—â–∞—è —Ü–µ–ª—å:</span>
                        <span class="detail-value" id="current-target">-</span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">–ü—Ä–æ—Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–æ –ø–æ—Ä—Ç–æ–≤:</span>
                        <span class="detail-value" id="scanned-ports">0</span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">–ù–∞–π–¥–µ–Ω–æ –æ—Ç–∫—Ä—ã—Ç—ã—Ö:</span>
                        <span class="detail-value" id="found-open">0</span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">–û—Å—Ç–∞–≤—à–µ–µ—Å—è –≤—Ä–µ–º—è:</span>
                        <span class="detail-value" id="remaining-time">-</span>
                    </div>
                </div>

                <!-- Real-time Activity Feed -->
                <div class="activity-feed">
                    <div class="activity-header">
                        <h4>–ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏</h4>
                        <button class="activity-toggle" id="toggle-activity">
                            <i class="fas fa-chevron-up"></i>
                        </button>
                    </div>
                    <div class="activity-log" id="activity-log">
                        <!-- Activity items will be added here -->
                    </div>
                </div>
            </div>
        </div>

        <!-- Scan Results -->
        <div class="scan-results" id="scan-results">
            <div class="scan-results__header">
                <div class="results-title-section">
                    <h2 class="results-title">–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è</h2>
                    <div class="results-meta" id="results-meta">
                        <!-- Results metadata will be populated here -->
                    </div>
                </div>

                <div class="results-controls">
                    <!-- View Mode Selector -->
                    <div class="view-modes">
                        <button class="view-btn active" data-view="summary" title="–°–≤–æ–¥–∫–∞">
                            <i class="fas fa-chart-pie"></i>
                        </button>
                        <button class="view-btn" data-view="detailed" title="–ü–æ–¥—Ä–æ–±–Ω–æ">
                            <i class="fas fa-list"></i>
                        </button>
                        <button class="view-btn" data-view="visualization" title="–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è">
                            <i class="fas fa-project-diagram"></i>
                        </button>
                    </div>

                    <!-- Export Options -->
                    <div class="export-controls">
                        <button class="export-btn" id="export-results">
                            <i class="fas fa-download"></i>
                            –≠–∫—Å–ø–æ—Ä—Ç
                        </button>
                        <div class="export-dropdown" id="export-dropdown">
                            <div class="export-option" data-format="json">
                                <i class="fas fa-file-code"></i>
                                JSON
                            </div>
                            <div class="export-option" data-format="xml">
                                <i class="fas fa-file-code"></i>
                                XML
                            </div>
                            <div class="export-option" data-format="csv">
                                <i class="fas fa-file-csv"></i>
                                CSV
                            </div>
                            <div class="export-option" data-format="pdf">
                                <i class="fas fa-file-pdf"></i>
                                PDF Report
                            </div>
                        </div>
                    </div>

                    <!-- Filter and Search -->
                    <div class="results-search">
                        <input type="text" class="search-input" placeholder="–ü–æ–∏—Å–∫ –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞—Ö..."
                            id="results-search">
                        <button class="filter-btn" id="results-filter">
                            <i class="fas fa-filter"></i>
                        </button>
                    </div>
                </div>
            </div>

            <!-- Results Content -->
            <div class="results-content">
                <!-- Summary View -->
                <div class="results-view active" id="summary-view">
                    <!-- Statistics Summary -->
                    <div class="summary-stats">
                        <div class="stat-card hosts">
                            <div class="stat-icon">
                                <i class="fas fa-desktop"></i>
                            </div>
                            <div class="stat-info">
                                <div class="stat-number" id="total-hosts">0</div>
                                <div class="stat-label">–ù–∞–π–¥–µ–Ω–æ —Ö–æ—Å—Ç–æ–≤</div>
                            </div>
                            <div class="stat-trend">
                                <i class="fas fa-arrow-up"></i>
                                <span>+12%</span>
                            </div>
                        </div>

                        <div class="stat-card ports">
                            <div class="stat-icon">
                                <i class="fas fa-door-open"></i>
                            </div>
                            <div class="stat-info">
                                <div class="stat-number" id="open-ports-count">0</div>
                                <div class="stat-label">–û—Ç–∫—Ä—ã—Ç—ã—Ö –ø–æ—Ä—Ç–æ–≤</div>
                            </div>
                            <div class="stat-trend">
                                <i class="fas fa-arrow-up"></i>
                                <span>+8%</span>
                            </div>
                        </div>

                        <div class="stat-card services">
                            <div class="stat-icon">
                                <i class="fas fa-cogs"></i>
                            </div>
                            <div class="stat-info">
                                <div class="stat-number" id="identified-services">0</div>
                                <div class="stat-label">–û–ø—Ä–µ–¥–µ–ª–µ–Ω–æ —Å–µ—Ä–≤–∏—Å–æ–≤</div>
                            </div>
                            <div class="stat-trend">
                                <i class="fas fa-arrow-up"></i>
                                <span>+5%</span>
                            </div>
                        </div>

                        <div class="stat-card vulnerabilities">
                            <div class="stat-icon">
                                <i class="fas fa-exclamation-triangle"></i>
                            </div>
                            <div class="stat-info">
                                <div class="stat-number" id="potential-vulns">0</div>
                                <div class="stat-label">–ü–æ—Ç–µ–Ω—Ü. —É—è–∑–≤–∏–º–æ—Å—Ç–∏</div>
                            </div>
                            <div class="stat-trend warning">
                                <i class="fas fa-exclamation"></i>
                                <span>–í–Ω–∏–º–∞–Ω–∏–µ</span>
                            </div>
                        </div>
                    </div>

                    <!-- Charts Section -->
                    <div class="charts-section">
                        <div class="chart-container">
                            <h4>–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ—Ä—Ç–æ–≤ –ø–æ —Å—Ç–∞—Ç—É—Å—É</h4>
                            <canvas id="ports-chart"></canvas>
                        </div>
                        <div class="chart-container">
                            <h4>–¢–æ–ø —Å–µ—Ä–≤–∏—Å–æ–≤</h4>
                            <canvas id="services-chart"></canvas>
                        </div>
                    </div>
                </div>

                <!-- Detailed View -->
                <div class="results-view" id="detailed-view">
                    <!-- Port Scanner Results -->
                    <div class="port-scanner" id="port-scanner-results">
                        <div class="port-scanner__header">
                            <h3 class="port-scanner__title">–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –ø–æ—Ä—Ç–æ–≤</h3>
                            <div class="port-scanner__controls">
                                <button class="control-btn" id="group-by-host">
                                    <i class="fas fa-desktop"></i>
                                    –ü–æ —Ö–æ—Å—Ç–∞–º
                                </button>
                                <button class="control-btn" id="group-by-port">
                                    <i class="fas fa-door-open"></i>
                                    –ü–æ –ø–æ—Ä—Ç–∞–º
                                </button>
                                <button class="control-btn" id="show-only-open">
                                    <i class="fas fa-filter"></i>
                                    –¢–æ–ª—å–∫–æ –æ—Ç–∫—Ä—ã—Ç—ã–µ
                                </button>
                            </div>
                        </div>

                        <div class="port-scanner__results">
                            <!-- Results table will be populated here -->
                            <div class="table-container">
                                <table class="port-scanner__table" id="results-table">
                                    <thead>
                                        <tr>
                                            <th class="sortable" data-sort="host">
                                                <i class="fas fa-desktop"></i>
                                                –•–æ—Å—Ç
                                                <i class="sort-indicator fas fa-sort"></i>
                                            </th>
                                            <th class="sortable" data-sort="port">
                                                <i class="fas fa-door-open"></i>
                                                –ü–æ—Ä—Ç
                                                <i class="sort-indicator fas fa-sort"></i>
                                            </th>
                                            <th class="sortable" data-sort="status">
                                                <i class="fas fa-info-circle"></i>
                                                –°—Ç–∞—Ç—É—Å
                                                <i class="sort-indicator fas fa-sort"></i>
                                            </th>
                                            <th class="sortable" data-sort="service">
                                                <i class="fas fa-cog"></i>
                                                –°–µ—Ä–≤–∏—Å
                                                <i class="sort-indicator fas fa-sort"></i>
                                            </th>
                                            <th class="sortable" data-sort="version">
                                                <i class="fas fa-tag"></i>
                                                –í–µ—Ä—Å–∏—è
                                                <i class="sort-indicator fas fa-sort"></i>
                                            </th>
                                            <th>
                                                <i class="fas fa-tools"></i>
                                                –î–µ–π—Å—Ç–≤–∏—è
                                            </th>
                                        </tr>
                                    </thead>
                                    <tbody id="results-table-body">
                                        <!-- Results will be populated dynamically -->
                                    </tbody>
                                </table>
                            </div>
                        </div>

                        <!-- Pagination -->
                        <div class="port-scanner__pagination">
                            <div class="pagination-info">
                                –ü–æ–∫–∞–∑–∞–Ω–æ <span id="pagination-start">1</span>-<span id="pagination-end">25</span> –∏–∑
                                <span id="pagination-total">0</span> —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
                            </div>
                            <div class="pagination-controls">
                                <button class="port-scanner__pagination-btn" id="prev-page" disabled>
                                    <i class="fas fa-chevron-left"></i>
                                    –ü—Ä–µ–¥—ã–¥—É—â–∞—è
                                </button>
                                <div class="page-numbers" id="page-numbers">
                                    <!-- Page numbers will be generated -->
                                </div>
                                <button class="port-scanner__pagination-btn" id="next-page">
                                    –°–ª–µ–¥—É—é—â–∞—è
                                    <i class="fas fa-chevron-right"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Visualization View -->
                <div class="results-view" id="visualization-view">
                    <div class="visualization-container">
                        <div class="viz-controls">
                            <button class="viz-btn active" data-viz="network-map">
                                <i class="fas fa-project-diagram"></i>
                                –ö–∞—Ä—Ç–∞ —Å–µ—Ç–∏
                            </button>
                            <button class="viz-btn" data-viz="port-heatmap">
                                <i class="fas fa-th"></i>
                                –¢–µ–ø–ª–æ–≤–∞—è –∫–∞—Ä—Ç–∞ –ø–æ—Ä—Ç–æ–≤
                            </button>
                            <button class="viz-btn" data-viz="timeline">
                                <i class="fas fa-chart-line"></i>
                                –í—Ä–µ–º–µ–Ω–Ω–∞—è —à–∫–∞–ª–∞
                            </button>
                        </div>

                        <div class="viz-content" id="viz-content">
                            <!-- Visualization content will be rendered here -->
                            <div class="viz-placeholder">
                                <i class="fas fa-chart-network"></i>
                                <p>–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–∞ –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Empty State -->
                <div class="port-scanner__empty" id="results-empty">
                    <div class="port-scanner__empty-icon">
                        <i class="fas fa-search"></i>
                    </div>
                    <div class="port-scanner__empty-text">
                        <h3>–ù–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è</h3>
                        <p>–ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Scanner Actions Area -->
    <div class="scanner__actions-area">
        <!-- Recent Scans -->
        <div class="recent-scans">
            <h3>–ù–µ–¥–∞–≤–Ω–∏–µ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è</h3>
            <div class="scans-list" id="recent-scans-list">
                <!-- Recent scan items will be populated here -->
            </div>
            <button class="btn btn--secondary btn--sm" id="view-all-scans">
                <i class="fas fa-history"></i>
                –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –≤—Å–µ
            </button>
        </div>

        <!-- Global Actions -->
        <div class="global-actions">
            <button class="scanner__reset-btn" id="reset-all">
                <i class="fas fa-refresh"></i>
                –°–±—Ä–æ—Å–∏—Ç—å –≤—Å–µ
            </button>
            <button class="btn btn--primary" id="new-scan">
                <i class="fas fa-plus"></i>
                –ù–æ–≤–æ–µ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ
            </button>
        </div>
    </div>

    <!-- Global Loading Indicator -->
    <div class="scanner__global-loading" id="global-loading" style="display: none;">
        <div class="scanner__spinner-lg"></div>
    </div>
</div>

<!-- Templates for Dynamic Content -->
<script type="text/template" id="scan-result-template">
    <tr class="result-row" data-host="{{host}}" data-port="{{port}}" data-status="{{status}}">
        <td class="host-cell">
            <div class="host-info">
                <div class="host-ip">{{host}}</div>
                {{#if hostname}}
                <div class="host-name">{{hostname}}</div>
                {{/if}}
            </div>
        </td>
        <td class="port-cell">
            <div class="port-info">
                <span class="port-number">{{port}}</span>
                {{#if protocol}}
                <span class="port-protocol">{{protocol}}</span>
                {{/if}}
            </div>
        </td>
        <td class="status-cell">
            <span class="port-scanner__status port-scanner__status--{{status}}">
                <i class="fas fa-{{statusIcon}}"></i>
                {{statusText}}
            </span>
        </td>
        <td class="service-cell">
            {{#if service}}
            <div class="service-info">
                <span class="service-name">{{service}}</span>
                {{#if product}}
                <span class="service-product">{{product}}</span>
                {{/if}}
            </div>
            {{else}}
            <span class="no-service">–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ</span>
            {{/if}}
        </td>
        <td class="version-cell">
            {{#if version}}
            <span class="version-info">{{version}}</span>
            {{else}}
            <span class="no-version">-</span>
            {{/if}}
        </td>
        <td class="actions-cell">
            <div class="row-actions">
                <button class="action-btn" onclick="showPortDetails('{{host}}', '{{port}}')" title="–ü–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏">
                    <i class="fas fa-info-circle"></i>
                </button>
                <button class="action-btn" onclick="scanPort('{{host}}', '{{port}}')" title="–ü–µ—Ä–µ—Å–∫–∞–Ω–∏—Ä–æ–≤–∞—Ç—å">
                    <i class="fas fa-redo"></i>
                </button>
                <button class="action-btn" onclick="exploreService('{{host}}', '{{port}}')" title="–ò—Å—Å–ª–µ–¥–æ–≤–∞—Ç—å —Å–µ—Ä–≤–∏—Å">
                    <i class="fas fa-external-link-alt"></i>
                </button>
            </div>
        </td>
    </tr>
</script>

<script type="text/template" id="activity-item-template">
    <div class="activity-item {{type}}">
        <div class="activity-time">{{timestamp}}</div>
        <div class="activity-content">
            <i class="activity-icon {{iconClass}}"></i>
            <span class="activity-text">{{message}}</span>
        </div>
    </div>
</script>

<script type="text/template" id="recent-scan-template">
    <div class="scan-item" data-scan-id="{{id}}">
        <div class="scan-info">
            <div class="scan-target">{{target}}</div>
            <div class="scan-time">{{timeAgo}}</div>
        </div>
        <div class="scan-stats">
            <span class="stat-hosts">{{hostsFound}} —Ö–æ—Å—Ç–æ–≤</span>
            <span class="stat-ports">{{portsScanned}} –ø–æ—Ä—Ç–æ–≤</span>
        </div>
        <div class="scan-status {{statusClass}}">{{statusText}}</div>
        <div class="scan-actions">
            <button class="scan-action-btn" onclick="loadScanResults('{{id}}')" title="–ó–∞–≥—Ä—É–∑–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã">
                <i class="fas fa-eye"></i>
            </button>
            <button class="scan-action-btn" onclick="repeatScan('{{id}}')" title="–ü–æ–≤—Ç–æ—Ä–∏—Ç—å">
                <i class="fas fa-redo"></i>
            </button>
        </div>
    </div>
</script>

<!-- Enhanced JavaScript Initialization -->
<script src="../scanner/scan-form.js" defer></script>
<script src="../scanner/scan-results.js" defer></script>
<script src="../scanner/port-scanner.js" defer></script>
<script src="../scanner/scanner.js" defer></script>

<script>
    document.addEventListener('DOMContentLoaded', () => {
        console.log('üîç Initializing Advanced Scanner Module');

        // Initialize Enhanced Scanner Controller
        const scannerController = new ScannerController({
            container: '#scanner-container',
            autoRefresh: true,
            enableRealTime: true,
            enableVisualizations: true,
            enableExport: true,
            maxConcurrentScans: 5,
            defaultTimeout: 5000,
            defaultThreads: 50,
            onScanStart: (config) => {
                console.log('üöÄ Scan started:', config);
                showScanProgress();
                updateScanStats();
            },
            onScanProgress: (progress) => {
                console.log('üìä Scan progress:', progress);
                updateProgressBar(progress);
                updateActivityFeed(progress.activity);
            },
            onScanComplete: (results) => {
                console.log('‚úÖ Scan completed:', results);
                hideScanProgress();
                displayScanResults(results);
                updateGlobalStats(results);
            },
            onError: (error) => {
                console.error('‚ùå Scanner error:', error);
                showErrorNotification('–û—à–∏–±–∫–∞ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è: ' + error.message);
            }
        });

        // Initialize Enhanced Scan Form
        const scanForm = new ScanForm('scan-form', {
            autoValidation: true,
            realTimePreview: true,
            enablePresets: true,
            enableHistory: true,
            onValidationChange: (isValid, errors) => {
                updateFormValidation(isValid, errors);
            },
            onStart: (config) => {
                console.log('üéØ Starting scan with config:', config);
                scannerController.startScan(config);
            },
            onPresetSave: (preset) => {
                console.log('üíæ Preset saved:', preset);
                showSuccessNotification('–ü—Ä–µ—Å–µ—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω');
            }
        });

        // Initialize Enhanced Port Scanner
        const portScanner = new PortScanner('port-scanner-results', {
            enableSorting: true,
            enableFiltering: true,
            enablePagination: true,
            pageSize: 25,
            enableGrouping: true,
            enableExport: true,
            onResultSelect: (result) => {
                console.log('üìã Result selected:', result);
                showResultDetails(result);
            },
            onBulkAction: (action, results) => {
                console.log('üîß Bulk action:', action, results);
                handleBulkAction(action, results);
            }
        });

        // Initialize Scan Results Controller
        const scanResults = new ScanResults('scan-results', {
            enableVisualization: true,
            enableExport: true,
            enableFiltering: true,
            enableRealTimeUpdates: true,
            chartOptions: {
                responsive: true,
                maintainAspectRatio: false
            },
            onViewChange: (view) => {
                console.log('üëÅÔ∏è View changed to:', view);
                updateResultsView(view);
            },
            onExport: (format, data) => {
                console.log('üì§ Exporting to:', format);
                handleExport(format, data);
            }
        });

        // Setup enhanced event handlers
        setupEnhancedEventHandlers();

        // Setup form mode switching
        setupFormModeHandlers();

        // Setup visualization handlers
        setupVisualizationHandlers();

        // Setup real-time features
        setupRealTimeFeatures();

        // Setup keyboard shortcuts
        setupKeyboardShortcuts();

        // Setup export functionality
        setupExportFunctionality();

        // Load initial data
        loadInitialData();
    });

    // Enhanced event handlers
    function setupEnhancedEventHandlers() {
        // Quick action buttons
        document.getElementById('quick-scan-local').addEventListener('click', () => {
            quickScanLocal();
        });

        document.getElementById('import-targets').addEventListener('click', () => {
            openTargetImportDialog();
        });

        document.getElementById('scan-history').addEventListener('click', () => {
            showScanHistory();
        });

        // Form mode switching
        document.querySelectorAll('.mode-btn').forEach(btn => {
            btn.addEventListener('click', (e) => {
                const mode = e.target.closest('.mode-btn').dataset.mode;
                switchFormMode(mode);
            });
        });

        // View mode switching
        document.querySelectorAll('.view-btn').forEach(btn => {
            btn.addEventListener('click', (e) => {
                const view = e.target.closest('.view-btn').dataset.view;
                switchResultsView(view);
            });
        });

        // Export dropdown
        document.getElementById('export-results').addEventListener('click', (e) => {
            e.stopPropagation();
            toggleExportDropdown();
        });

        document.querySelectorAll('.export-option').forEach(option => {
            option.addEventListener('click', (e) => {
                const format = e.target.closest('.export-option').dataset.format;
                exportResults(format);
            });
        });

        // Progress controls
        document.getElementById('pause-scan')?.addEventListener('click', pauseScan);
        document.getElementById('stop-scan')?.addEventListener('click', stopScan);
        document.getElementById('toggle-activity')?.addEventListener('click', toggleActivityFeed);

        // Table sorting
        document.querySelectorAll('.sortable').forEach(header => {
            header.addEventListener('click', (e) => {
                const sortBy = e.target.closest('.sortable').dataset.sort;
                sortResults(sortBy);
            });
        });

        // Results search
        document.getElementById('results-search').addEventListener('input', debounce((e) => {
            filterResults(e.target.value);
        }, 300));

        // Command builder
        document.querySelectorAll('.builder-select').forEach(select => {
            select.addEventListener('change', updateCustomCommand);
        });

        // Ports preset button
        document.getElementById('ports-preset').addEventListener('click', showPortsPresets);

        // Speed slider
        document.getElementById('scan-speed').addEventListener('input', (e) => {
            updateSpeedIndicator(e.target.value);
        });
    }

    // Form mode switching
    function setupFormModeHandlers() {
        // Handle mode switching logic
        function switchFormMode(mode) {
            // Update active button
            document.querySelectorAll('.mode-btn').forEach(btn => {
                btn.classList.toggle('active', btn.dataset.mode === mode);
            });

            // Switch form mode content
            document.querySelectorAll('.form-mode').forEach(modeDiv => {
                modeDiv.classList.toggle('active', modeDiv.id === `${mode}-mode`);
            });

            console.log(`üìã Switched to ${mode} mode`);
        }

        window.switchFormMode = switchFormMode;
    }

    // Visualization handlers
    function setupVisualizationHandlers() {
        document.querySelectorAll('.viz-btn').forEach(btn => {
            btn.addEventListener('click', (e) => {
                const vizType = e.target.closest('.viz-btn').dataset.viz;
                switchVisualization(vizType);
            });
        });
    }

    // Real-time features
    function setupRealTimeFeatures() {
        if (window.WebSocket) {
            const ws = new WebSocket('/ws/scanner');

            ws.onmessage = (event) => {
                const data = JSON.parse(event.data);
                handleRealTimeUpdate(data);
            };

            ws.onopen = () => {
                console.log('üîå Scanner WebSocket connected');
            };

            ws.onclose = () => {
                console.log('üì¥ Scanner WebSocket disconnected');
                setTimeout(setupRealTimeFeatures, 5000);
            };
        }
    }

    // Keyboard shortcuts
    function setupKeyboardShortcuts() {
        document.addEventListener('keydown', (e) => {
            if (e.ctrlKey || e.metaKey) {
                switch (e.key) {
                    case 'Enter':
                        if (e.target.closest('#scan-form')) {
                            e.preventDefault();
                            startScan();
                        }
                        break;
                    case 's':
                        e.preventDefault();
                        startScan();
                        break;
                    case 'e':
                        e.preventDefault();
                        exportResults('json');
                        break;
                    case 'h':
                        e.preventDefault();
                        showScanHistory();
                        break;
                    case 'r':
                        e.preventDefault();
                        resetForm();
                        break;
                }
            }

            if (e.key === 'Escape') {
                if (document.getElementById('scan-progress').style.display !== 'none') {
                    stopScan();
                }
                closeAllDropdowns();
            }
        });
    }

    // Export functionality
    function setupExportFunctionality() {
        const exportFormats = ['json', 'xml', 'csv', 'pdf'];

        exportFormats.forEach(format => {
            window[`export${format.toUpperCase()}`] = () => exportResults(format);
        });
    }

    // Implementation functions
    function quickScanLocal() {
        console.log('üè† Quick scan local network');

        // Auto-detect local network
        const localNetwork = detectLocalNetwork();
        document.getElementById('target-input').value = localNetwork;
        document.getElementById('scan-type').value = 'port_scan';

        // Start scan immediately
        startScan();
    }

    function detectLocalNetwork() {
        // Simple local network detection (would be more sophisticated in real implementation)
        return '192.168.1.0/24';
    }

    function startScan() {
        console.log('üöÄ Starting scan');

        const startBtn = document.getElementById('start-scan');
        const loadingIndicator = document.getElementById('scan-loading');

        // Update UI
        startBtn.disabled = true;
        loadingIndicator.style.display = 'flex';

        // Show progress
        showScanProgress();

        // Simulate scan progress
        simulateScanProgress();
    }

    function showScanProgress() {
        const progressDiv = document.getElementById('scan-progress');
        const resultsDiv = document.getElementById('scan-results');

        progressDiv.style.display = 'block';
        resultsDiv.querySelector('#results-empty').style.display = 'none';

        // Start progress animation
        let progress = 0;
        const progressInterval = setInterval(() => {
            progress += Math.random() * 10;
            if (progress >= 100) {
                progress = 100;
                clearInterval(progressInterval);
                setTimeout(() => {
                    completeScan();
                }, 1000);
            }

            updateProgressBar({ percent: progress });
            addActivityItem({
                type: 'info',
                message: `Scanning target ${Math.floor(progress / 10 + 1)}...`,
                timestamp: new Date().toLocaleTimeString()
            });
        }, 500 + Math.random() * 1000);
    }

    function updateProgressBar(progress) {
        const progressFill = document.getElementById('progress-fill');
        const progressPercent = document.getElementById('progress-percent');

        if (progressFill && progressPercent) {
            progressFill.style.width = `${progress.percent}%`;
            progressPercent.textContent = `${Math.floor(progress.percent)}%`;
        }
    }

    function addActivityItem(activity) {
        const activityLog = document.getElementById('activity-log');
        if (!activityLog) return;

        const activityItem = document.createElement('div');
        activityItem.className = `activity-item ${activity.type}`;
        activityItem.innerHTML = `
        <div class="activity-time">${activity.timestamp}</div>
        <div class="activity-content">
            <i class="activity-icon fas fa-${activity.type === 'success' ? 'check' : 'info'}"></i>
            <span class="activity-text">${activity.message}</span>
        </div>
    `;

        activityLog.insertBefore(activityItem, activityLog.firstChild);

        // Limit activity items
        const items = activityLog.children;
        if (items.length > 20) {
            activityLog.removeChild(items[items.length - 1]);
        }
    }

    function completeScan() {
        console.log('‚úÖ Scan completed');

        hideScanProgress();
        generateSampleResults();

        // Reset form
        const startBtn = document.getElementById('start-scan');
        const loadingIndicator = document.getElementById('scan-loading');

        startBtn.disabled = false;
        loadingIndicator.style.display = 'none';

        showSuccessNotification('–°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–æ —É—Å–ø–µ—à–Ω–æ');
    }

    function hideScanProgress() {
        const progressDiv = document.getElementById('scan-progress');
        progressDiv.style.display = 'none';
    }

    function generateSampleResults() {
        console.log('üìä Generating sample results');

        // Show results section
        const emptyState = document.getElementById('results-empty');
        emptyState.style.display = 'none';

        // Update statistics
        document.getElementById('total-hosts').textContent = '24';
        document.getElementById('open-ports-count').textContent = '156';
        document.getElementById('identified-services').textContent = '89';
        document.getElementById('potential-vulns').textContent = '12';

        // Generate table results
        generateSampleTableResults();

        // Update charts
        updateChartsWithSampleData();
    }

    function generateSampleTableResults() {
        const tableBody = document.getElementById('results-table-body');
        if (!tableBody) return;

        const sampleResults = [
            { host: '192.168.1.1', port: '22', status: 'open', service: 'ssh', version: 'OpenSSH 8.0' },
            { host: '192.168.1.1', port: '80', status: 'open', service: 'http', version: 'Apache 2.4.41' },
            { host: '192.168.1.1', port: '443', status: 'open', service: 'https', version: 'Apache 2.4.41' },
            { host: '192.168.1.10', port: '3389', status: 'open', service: 'rdp', version: 'Microsoft Terminal Services' },
            { host: '192.168.1.20', port: '21', status: 'open', service: 'ftp', version: 'vsftpd 3.0.3' },
            { host: '192.168.1.25', port: '22', status: 'filtered', service: 'ssh', version: null },
            { host: '192.168.1.30', port: '3306', status: 'open', service: 'mysql', version: 'MySQL 8.0.25' },
            { host: '192.168.1.35', port: '5432', status: 'open', service: 'postgresql', version: 'PostgreSQL 13.0' }
        ];

        tableBody.innerHTML = sampleResults.map(result => `
        <tr class="result-row" data-host="${result.host}" data-port="${result.port}" data-status="${result.status}">
            <td class="host-cell">
                <div class="host-info">
                    <div class="host-ip">${result.host}</div>
                </div>
            </td>
            <td class="port-cell">
                <div class="port-info">
                    <span class="port-number">${result.port}</span>
                    <span class="port-protocol">tcp</span>
                </div>
            </td>
            <td class="status-cell">
                <span class="port-scanner__status port-scanner__status--${result.status}">
                    <i class="fas fa-${result.status === 'open' ? 'check-circle' : result.status === 'closed' ? 'times-circle' : 'question-circle'}"></i>
                    ${result.status === 'open' ? '–û—Ç–∫—Ä—ã—Ç' : result.status === 'closed' ? '–ó–∞–∫—Ä—ã—Ç' : '–§–∏–ª—å—Ç—Ä—É–µ—Ç—Å—è'}
                </span>
            </td>
            <td class="service-cell">
                ${result.service ? `<span class="service-name">${result.service}</span>` : '<span class="no-service">–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ</span>'}
            </td>
            <td class="version-cell">
                ${result.version ? `<span class="version-info">${result.version}</span>` : '<span class="no-version">-</span>'}
            </td>
            <td class="actions-cell">
                <div class="row-actions">
                    <button class="action-btn" onclick="showPortDetails('${result.host}', '${result.port}')" title="–ü–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏">
                        <i class="fas fa-info-circle"></i>
                    </button>
                    <button class="action-btn" onclick="scanPort('${result.host}', '${result.port}')" title="–ü–µ—Ä–µ—Å–∫–∞–Ω–∏—Ä–æ–≤–∞—Ç—å">
                        <i class="fas fa-redo"></i>
                    </button>
                </div>
            </td>
        </tr>
    `).join('');

        // Update pagination
        updatePagination(sampleResults.length);
    }

    function updateChartsWithSampleData() {
        // Port status chart
        const portsCanvas = document.getElementById('ports-chart');
        if (portsCanvas && window.Chart) {
            new Chart(portsCanvas, {
                type: 'doughnut',
                data: {
                    labels: ['–û—Ç–∫—Ä—ã—Ç', '–ó–∞–∫—Ä—ã—Ç', '–§–∏–ª—å—Ç—Ä—É–µ—Ç—Å—è'],
                    datasets: [{
                        data: [156, 892, 34],
                        backgroundColor: [
                            'var(--color-success)',
                            'var(--color-error)',
                            'var(--color-warning)'
                        ]
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false
                }
            });
        }

        // Services chart
        const servicesCanvas = document.getElementById('services-chart');
        if (servicesCanvas && window.Chart) {
            new Chart(servicesCanvas, {
                type: 'bar',
                data: {
                    labels: ['HTTP', 'SSH', 'FTP', 'MySQL', 'RDP', 'DNS'],
                    datasets: [{
                        data: [45, 32, 18, 12, 8, 6],
                        backgroundColor: 'var(--color-primary)'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true
                        }
                    }
                }
            });
        }
    }

    // Utility functions
    function switchResultsView(view) {
        console.log('üëÅÔ∏è Switching to view:', view);

        // Update active button
        document.querySelectorAll('.view-btn').forEach(btn => {
            btn.classList.toggle('active', btn.dataset.view === view);
        });

        // Switch view content
        document.querySelectorAll('.results-view').forEach(viewDiv => {
            viewDiv.classList.toggle('active', viewDiv.id === `${view}-view`);
        });
    }

    function exportResults(format) {
        console.log('üì§ Exporting results as:', format);

        // Close dropdown
        document.getElementById('export-dropdown').classList.remove('active');

        // Show loading
        showLoadingNotification('–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —ç–∫—Å–ø–æ—Ä—Ç–∞...');

        setTimeout(() => {
            hideLoadingNotification();
            showSuccessNotification(`–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã –≤ —Ñ–æ—Ä–º–∞—Ç–µ ${format.toUpperCase()}`);
        }, 2000);
    }

    function toggleExportDropdown() {
        const dropdown = document.getElementById('export-dropdown');
        dropdown.classList.toggle('active');
    }

    function sortResults(sortBy) {
        console.log('üîÑ Sorting results by:', sortBy);

        // Update sort indicators
        document.querySelectorAll('.sortable').forEach(header => {
            const indicator = header.querySelector('.sort-indicator');
            if (header.dataset.sort === sortBy) {
                indicator.classList.toggle('fa-sort');
                indicator.classList.toggle('fa-sort-up');
            } else {
                indicator.className = 'sort-indicator fas fa-sort';
            }
        });

        // Perform sorting (simplified)
        showSuccessNotification(`–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã –ø–æ: ${sortBy}`);
    }

    function filterResults(query) {
        console.log('üîç Filtering results:', query);

        const rows = document.querySelectorAll('#results-table-body .result-row');
        rows.forEach(row => {
            const text = row.textContent.toLowerCase();
            const match = text.includes(query.toLowerCase());
            row.style.display = match ? '' : 'none';
        });
    }

    function updatePagination(total) {
        document.getElementById('pagination-total').textContent = total;
        document.getElementById('pagination-start').textContent = '1';
        document.getElementById('pagination-end').textContent = Math.min(25, total).toString();
    }

    // Placeholder functions
    function pauseScan() { console.log('‚è∏Ô∏è Pause scan'); }
    function stopScan() { console.log('‚èπÔ∏è Stop scan'); }
    function toggleActivityFeed() { console.log('üìã Toggle activity feed'); }
    function resetForm() { console.log('üîÑ Reset form'); }
    function showPortDetails(host, port) { console.log('üìÑ Show port details:', host, port); }
    function scanPort(host, port) { console.log('üîç Scan port:', host, port); }
    function showScanHistory() { console.log('üìú Show scan history'); }
    function openTargetImportDialog() { console.log('üìÇ Import targets'); }
    function showPortsPresets() { console.log('üîß Show ports presets'); }
    function updateSpeedIndicator(value) { console.log('‚ö° Speed:', value); }
    function updateCustomCommand() { console.log('‚å®Ô∏è Update custom command'); }
    function switchVisualization(type) { console.log('üìä Switch visualization:', type); }
    function handleRealTimeUpdate(data) { console.log('üîÑ Real-time update:', data); }
    function closeAllDropdowns() { console.log('‚ùå Close dropdowns'); }
    function showSuccessNotification(message) { console.log('‚úÖ Success:', message); }
    function showErrorNotification(message) { console.log('‚ùå Error:', message); }
    function showLoadingNotification(message) { console.log('‚è≥ Loading:', message); }
    function hideLoadingNotification() { console.log('‚úÖ Loading complete'); }
    function loadInitialData() { console.log('üì• Loading initial data'); }
    function updateFormValidation(isValid, errors) { console.log('‚úÖ Form validation:', isValid, errors); }
    function updateScanStats() { console.log('üìä Update scan stats'); }
    function updateGlobalStats(results) { console.log('üìà Update global stats:', results); }
    function showResultDetails(result) { console.log('üìÑ Show result details:', result); }
    function handleBulkAction(action, results) { console.log('üîß Bulk action:', action, results); }
    function updateResultsView(view) { console.log('üëÅÔ∏è Update results view:', view); }
    function handleExport(format, data) { console.log('üì§ Handle export:', format, data); }

    // Debounce utility
    function debounce(func, wait) {
        let timeout;
        return function executedFunction(...args) {
            const later = () => {
                clearTimeout(timeout);
                func(...args);
            };
            clearTimeout(timeout);
            timeout = setTimeout(later, wait);
        };
    }
</script>

<style>
    /* Additional enhanced styles for scanner functionality */
    .scanner {
        display: grid;
        grid-template-rows: auto auto 1fr auto;
        background: var(--color-background);
        min-height: 100vh;
    }

    .scanner-header {
        display: flex;
        justify-content: space-between;
        align-items: flex-start;
        padding: var(--space-24);
        background: var(--color-surface);
        border-bottom: 1px solid var(--color-card-border);
    }

    .title-section {
        display: flex;
        flex-direction: column;
        gap: var(--space-8);
    }

    .scanner-title {
        display: flex;
        align-items: center;
        gap: var(--space-12);
        font-size: var(--font-size-2xl);
        font-weight: var(--font-weight-bold);
        color: var(--color-text);
        margin: 0;
    }

    .scanner-title i {
        color: var(--color-primary);
    }

    .scanner-subtitle {
        color: var(--color-text-secondary);
        font-size: var(--font-size-base);
        margin: 0;
    }

    .scanner-stats {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: var(--space-16);
        margin-top: var(--space-16);
    }

    .stat-item {
        display: flex;
        align-items: center;
        gap: var(--space-12);
        padding: var(--space-12) var(--space-16);
        background: var(--color-secondary);
        border-radius: var(--radius-base);
        border: 1px solid var(--color-border);
    }

    .stat-item i {
        font-size: var(--font-size-xl);
        color: var(--color-primary);
    }

    .stat-value {
        font-size: var(--font-size-xl);
        font-weight: var(--font-weight-bold);
        color: var(--color-text);
        font-family: var(--font-family-mono);
    }

    .stat-label {
        font-size: var(--font-size-sm);
        color: var(--color-text-secondary);
    }

    .quick-actions {
        display: flex;
        gap: var(--space-12);
    }

    .quick-action-btn {
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: var(--space-4);
        padding: var(--space-12);
        background: transparent;
        border: 1px solid var(--color-border);
        border-radius: var(--radius-base);
        color: var(--color-text-secondary);
        cursor: pointer;
        transition: all var(--duration-fast) var(--ease-standard);
        min-width: 100px;
    }

    .quick-action-btn:hover {
        background: var(--color-secondary);
        color: var(--color-text);
        border-color: var(--color-primary);
    }

    .quick-action-btn i {
        font-size: var(--font-size-lg);
    }

    .quick-action-btn span {
        font-size: var(--font-size-xs);
        font-weight: var(--font-weight-medium);
    }

    .form-mode-selector {
        display: flex;
        gap: var(--space-4);
    }

    .mode-btn {
        display: flex;
        align-items: center;
        gap: var(--space-6);
        padding: var(--space-6) var(--space-12);
        background: transparent;
        border: 1px solid var(--color-border);
        border-radius: var(--radius-base);
        color: var(--color-text-secondary);
        cursor: pointer;
        font-size: var(--font-size-sm);
        transition: all var(--duration-fast) var(--ease-standard);
    }

    .mode-btn:hover {
        background: var(--color-secondary);
        color: var(--color-text);
    }

    .mode-btn.active {
        background: var(--color-primary);
        color: var(--color-btn-primary-text);
        border-color: var(--color-primary);
    }

    .form-mode {
        display: none;
    }

    .form-mode.active {
        display: block;
    }

    .form-row {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: var(--space-24);
        margin-bottom: var(--space-20);
    }

    .input-with-validation {
        position: relative;
    }

    .input-status {
        position: absolute;
        right: var(--space-12);
        top: 50%;
        transform: translateY(-50%);
        width: var(--space-16);
        height: var(--space-16);
        border-radius: 50%;
        display: none;
    }

    .input-status.valid {
        background: var(--color-success);
        display: block;
    }

    .input-status.invalid {
        background: var(--color-error);
        display: block;
    }

    .ports-input-container {
        display: flex;
        gap: var(--space-8);
    }

    .ports-preset-btn {
        flex-shrink: 0;
        padding: var(--space-8) var(--space-12);
        background: var(--color-secondary);
        border: 1px solid var(--color-border);
        border-radius: var(--radius-base);
        color: var(--color-text-secondary);
        cursor: pointer;
        transition: all var(--duration-fast) var(--ease-standard);
    }

    .ports-preset-btn:hover {
        background: var(--color-primary);
        color: var(--color-btn-primary-text);
    }

    .speed-selector {
        display: flex;
        flex-direction: column;
        gap: var(--space-8);
    }

    .speed-slider {
        width: 100%;
    }

    .speed-labels {
        display: flex;
        justify-content: space-between;
        font-size: var(--font-size-xs);
        color: var(--color-text-secondary);
    }

    .speed-labels .active {
        color: var(--color-primary);
        font-weight: var(--font-weight-semibold);
    }

    .advanced-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: var(--space-24);
    }

    .advanced-section {
        padding: var(--space-16);
        background: var(--color-secondary);
        border-radius: var(--radius-base);
        border: 1px solid var(--color-border);
    }

    .section-title {
        display: flex;
        align-items: center;
        gap: var(--space-8);
        font-size: var(--font-size-base);
        font-weight: var(--font-weight-semibold);
        color: var(--color-text);
        margin: 0 0 var(--space-16) 0;
    }

    .section-title i {
        color: var(--color-primary);
    }

    .custom-config {
        max-width: 800px;
    }

    .scan-form__textarea {
        width: 100%;
        min-height: 120px;
        padding: var(--space-12);
        background: var(--color-background);
        border: 1px solid var(--color-border);
        border-radius: var(--radius-base);
        color: var(--color-text);
        font-family: var(--font-family-mono);
        font-size: var(--font-size-sm);
        resize: vertical;
    }

    .command-help {
        margin-top: var(--space-8);
    }

    .command-builder {
        margin-top: var(--space-20);
        padding: var(--space-16);
        background: var(--color-secondary);
        border-radius: var(--radius-base);
    }

    .builder-options {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: var(--space-16);
        margin-top: var(--space-12);
    }

    .builder-group {
        display: flex;
        flex-direction: column;
        gap: var(--space-4);
    }

    .builder-group label {
        font-size: var(--font-size-sm);
        color: var(--color-text);
        font-weight: var(--font-weight-medium);
    }

    .builder-select {
        padding: var(--space-6) var(--space-8);
        background: var(--color-background);
        border: 1px solid var(--color-border);
        border-radius: var(--radius-base);
        color: var(--color-text);
        font-size: var(--font-size-sm);
    }

    .summary-stats {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: var(--space-16);
        margin-bottom: var(--space-32);
    }

    .stat-card {
        display: flex;
        align-items: center;
        gap: var(--space-16);
        padding: var(--space-20);
        background: var(--color-surface);
        border: 1px solid var(--color-border);
        border-radius: var(--radius-lg);
        box-shadow: var(--shadow-sm);
    }

    .stat-icon {
        display: flex;
        align-items: center;
        justify-content: center;
        width: 48px;
        height: 48px;
        background: var(--color-primary);
        color: var(--color-btn-primary-text);
        border-radius: var(--radius-base);
        font-size: var(--font-size-xl);
    }

    .stat-info {
        flex: 1;
    }

    .stat-number {
        font-size: var(--font-size-2xl);
        font-weight: var(--font-weight-bold);
        color: var(--color-text);
        font-family: var(--font-family-mono);
        margin: 0 0 var(--space-2) 0;
    }

    .stat-label {
        font-size: var(--font-size-sm);
        color: var(--color-text-secondary);
    }

    .stat-trend {
        display: flex;
        align-items: center;
        gap: var(--space-4);
        font-size: var(--font-size-xs);
        color: var(--color-success);
        font-weight: var(--font-weight-semibold);
    }

    .stat-trend.warning {
        color: var(--color-warning);
    }

    .charts-section {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: var(--space-24);
    }

    .chart-container {
        padding: var(--space-20);
        background: var(--color-surface);
        border: 1px solid var(--color-border);
        border-radius: var(--radius-lg);
        box-shadow: var(--shadow-sm);
    }

    .chart-container h4 {
        margin: 0 0 var(--space-16) 0;
        color: var(--color-text);
        font-weight: var(--font-weight-semibold);
    }

    .chart-container canvas {
        max-height: 300px;
    }

    .export-dropdown {
        position: absolute;
        top: 100%;
        right: 0;
        margin-top: var(--space-4);
        background: var(--color-surface);
        border: 1px solid var(--color-border);
        border-radius: var(--radius-base);
        box-shadow: var(--shadow-lg);
        z-index: 1000;
        min-width: 150px;
        display: none;
    }

    .export-dropdown.active {
        display: block;
    }

    .export-option {
        display: flex;
        align-items: center;
        gap: var(--space-8);
        padding: var(--space-8) var(--space-12);
        cursor: pointer;
        transition: background var(--duration-fast) var(--ease-standard);
        font-size: var(--font-size-sm);
        color: var(--color-text);
    }

    .export-option:hover {
        background: var(--color-secondary);
    }

    .results-search {
        position: relative;
    }

    .search-input {
        padding: var(--space-6) var(--space-32) var(--space-6) var(--space-8);
        background: var(--color-secondary);
        border: 1px solid var(--color-border);
        border-radius: var(--radius-base);
        color: var(--color-text);
        font-size: var(--font-size-sm);
        width: 200px;
    }

    .filter-btn {
        position: absolute;
        right: var(--space-4);
        top: 50%;
        transform: translateY(-50%);
        background: transparent;
        border: none;
        color: var(--color-text-secondary);
        cursor: pointer;
        padding: var(--space-4);
    }

    .action-btn {
        padding: var(--space-4) var(--space-6);
        background: transparent;
        border: 1px solid var(--color-border);
        border-radius: var(--radius-sm);
        color: var(--color-text-secondary);
        cursor: pointer;
        transition: all var(--duration-fast) var(--ease-standard);
        font-size: var(--font-size-xs);
    }

    .action-btn:hover {
        background: var(--color-primary);
        color: var(--color-btn-primary-text);
        border-color: var(--color-primary);
    }

    .row-actions {
        display: flex;
        gap: var(--space-4);
    }

    /* Activity feed styles */
    .activity-feed {
        margin-top: var(--space-16);
        background: var(--color-secondary);
        border-radius: var(--radius-base);
        overflow: hidden;
    }

    .activity-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: var(--space-12) var(--space-16);
        background: var(--color-background);
        border-bottom: 1px solid var(--color-border);
    }

    .activity-header h4 {
        margin: 0;
        font-size: var(--font-size-base);
        color: var(--color-text);
    }

    .activity-toggle {
        background: transparent;
        border: none;
        color: var(--color-text-secondary);
        cursor: pointer;
        padding: var(--space-4);
        transition: color var(--duration-fast) var(--ease-standard);
    }

    .activity-toggle:hover {
        color: var(--color-text);
    }

    .activity-log {
        max-height: 200px;
        overflow-y: auto;
        padding: var(--space-8);
    }

    .activity-item {
        display: flex;
        align-items: center;
        gap: var(--space-8);
        padding: var(--space-4) 0;
        font-size: var(--font-size-xs);
    }

    .activity-time {
        color: var(--color-text-secondary);
        font-family: var(--font-family-mono);
        min-width: 70px;
    }

    .activity-content {
        display: flex;
        align-items: center;
        gap: var(--space-6);
    }

    .activity-icon {
        color: var(--color-primary);
    }

    .activity-text {
        color: var(--color-text);
    }

    .activity-item.success .activity-icon {
        color: var(--color-success);
    }

    .activity-item.error .activity-icon {
        color: var(--color-error);
    }

    /* Responsive design */
    @media (max-width: 1200px) {
        .form-row {
            grid-template-columns: 1fr;
            gap: var(--space-16);
        }

        .advanced-grid {
            grid-template-columns: 1fr;
        }

        .charts-section {
            grid-template-columns: 1fr;
        }
    }

    @media (max-width: 768px) {
        .scanner-header {
            flex-direction: column;
            gap: var(--space-16);
        }

        .scanner-stats {
            grid-template-columns: repeat(2, 1fr);
        }

        .quick-actions {
            width: 100%;
            justify-content: space-around;
        }

        .summary-stats {
            grid-template-columns: repeat(2, 1fr);
            gap: var(--space-12);
        }

        .results-controls {
            flex-wrap: wrap;
            gap: var(--space-8);
        }
    }

    @media (max-width: 480px) {
        .scanner-stats {
            grid-template-columns: 1fr;
        }

        .summary-stats {
            grid-template-columns: 1fr;
        }

        .form-mode-selector {
            flex-direction: column;
        }
    }
</style>